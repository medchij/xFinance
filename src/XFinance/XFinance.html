<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license. -->
<!-- See LICENSE in the project root for license information -->

<!doctype html>
<html lang="en" data-framework="javascript">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Xfinance Add-in</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/assets/favicon.ico" />

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    <!-- XLSX library -->
    <script type="text/javascript" src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="xFinance.css">
    
  </head>

  <body style="width: 100%; height: 100%; margin: 0; padding: 0">
    <div id="container"></div>

    <!-- Auto-configure backend URL for GitHub Codespaces (maps -3000 -> -4000) -->
    <script>
      (function () {
        try {
          var h = window.location.hostname;
          if (/\.app\.github\.dev$/.test(h)) {
            var m = h.match(/^(.*)-(\d+)\.app\.github\.dev$/);
            if (m) {
              window.__XFINANCE_API_URL = window.location.protocol + '//' + m[1] + '-4000.app.github.dev';
              // console.debug('XFINANCE API:', window.__XFINANCE_API_URL);
            }
          }
        } catch (e) { /* ignore */ }
      })();
    </script>

    <!-- 
        Fluent UI React v. 9 uses modern JavaScript syntax that is not supported in
        Trident (Internet Explorer) or EdgeHTML (Edge Legacy), so this add-in won't
        work in Office versions that use these webviews. The script below makes the 
        following div display when an unsupported webview is in use, and hides the 
        React container div. 
    -->
    <div id="tridentmessage" style="display: none; padding: 10">
      Энэ нэмэлт нь таны Office хувилбар дээр ажиллахгүй. Perpetual Office 2021 (эсвэл түүнээс хойшхи хувилбар) эсвэл Microsoft 365 бүртгэл рүү шинэчилнэ үү.
    </div>
    <script>
      // Check for old browsers (IE11/Trident and Edge Legacy/EdgeHTML)
      // Modern Chromium Edge (WebView2) contains "Edg/" not "Edge/"
      var ua = navigator.userAgent;
      var isIE11 = ua.indexOf("Trident") !== -1;
      var isEdgeLegacy = ua.indexOf("Edge/") !== -1; // Edge Legacy uses "Edge/" 
      var isUnsupported = isIE11 || isEdgeLegacy;
      
      if (isUnsupported) {
        var tridentMessage = document.getElementById("tridentmessage");
        var normalContainer = document.getElementById("container");
        tridentMessage.style.display = "block";
        normalContainer.style.display = "none";
      }
    </script>
  </body>
</html>
