/*! For license information please see page-settings.js.LICENSE.txt */
"use strict";(self.webpackChunkoffice_addin_taskpane_react_js=self.webpackChunkoffice_addin_taskpane_react_js||[]).push([[60],{927:function(e,n,t){t.d(n,{$A:function(){return r},CN:function(){return l},Ij:function(){return i},M5:function(){return o},kB:function(){return m},rj:function(){return c},sz:function(){return u},t5:function(){return s},tv:function(){return f}});var a=t(9027);async function r(e,n,t){try{e(!0);const n=await t();if(n?.response instanceof Response&&(console.log("üì° HTTP:",n.response.statusText+" "+n.response.status),!n.response.ok)){const e=await n.response.text();throw new Error("‚ùå –°–µ—Ä–≤–µ—Ä–∏–π–Ω –∞–ª–¥–∞–∞: "+e)}return n}catch(e){throw n("‚ùå –ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞: "+(e?.message||e)),console.error("API Error:",e?.message||e),e}finally{e(!1)}}async function o(){const e=await fetch(`${a.C}/api/settings`);if(!e.ok)throw new Error("‚ö†Ô∏è Settings.json —Ç–∞—Ç–∞–∂ —á–∞–¥—Å–∞–Ω–≥“Ø–π");return await e.json()}function l(e,n){return e.find((e=>e.name===n))?.value||""}function i(e,n){return e.find((e=>e.name===n))?.id||""}function s(e,n){if(!e||"number"!=typeof e&&"string"!=typeof e)throw new Error(`üìÖ ${n} –Ω“Ø–¥—ç–Ω–¥ –æ–≥–Ω–æ–æ –æ—Ä—É—É–ª–Ω–∞ —É—É (2025-01-30 —ç—Å–≤—ç–ª Excel –æ–≥–Ω–æ–æ–Ω—ã format)`);if("number"==typeof e){const n=new Date(1899,11,30);e=new Date(n.getTime()+864e5*e).toISOString().split("T")[0]}if("string"==typeof e&&!/^\d{4}-\d{2}-\d{2}$/.test(e))throw new Error(`üìÖ ${n} –±—É—Ä—É—É –±–∞–π–Ω–∞. YYYY-MM-DD —Ö—ç–ª–±—ç—Ä—Ç—ç–π –±–∞–π–≤–∞–ª –∑–æ—Ö–∏–º–∂—Ç–æ–π.`);return e.toString().trim()}function u(e){return"number"==typeof e&&e.toString().length>15?"'"+e.toString():"string"==typeof e&&/^\d{16,}$/.test(e)?"'"+e:e}async function c(e,n=14){try{await Excel.run((async t=>{const a=t.workbook.worksheets.getActiveWorksheet(),r=a.getUsedRange();r.load(["rowCount","columnCount"]),await t.sync();const o=r.rowCount,l=Math.max(0,r.columnCount-(n||0));console.log(`üìä –•—ç—Ä—ç–≥–ª—ç–≥–¥—ç–∂ –±—É–π –º—É–∂: ${o} –º”©—Ä, ${l} –±–∞–≥–∞–Ω–∞ (–±–∞—Ä—É—É–Ω–∞–∞—Å –∞–ª–≥–∞—Å—Å–∞–Ω: ${n})`);for(let e=0;e<l;e++){const n=a.getRangeByIndexes(0,e,o,1);n.load("values"),await t.sync(),n.values.flat().every((e=>null===e||""===e))&&(n.columnHidden=!0)}await t.sync(),e&&e("‚úÖ –•–æ–æ—Å–æ–Ω –±–∞–≥–∞–Ω—É—É–¥ –∞–º–∂–∏–ª—Ç—Ç–∞–π –Ω—É—É–∂ –¥—É—É—Å–ª–∞–∞.")}))}catch(n){console.error("‚ùå –•–æ–æ—Å–æ–Ω –±–∞–≥–∞–Ω–∞ –Ω—É—É—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞:",n),e&&e("‚ùå –ê–ª–¥–∞–∞: "+n.message)}}function f(e,n){const t=n?.status?.code,a=e.status,r=n?.status?.message||n?.message||n?.error||`–°–µ—Ä–≤–µ—Ä–∏–π–Ω —Ö–∞—Ä–∏—É –∞–º–∂–∏–ª—Ç–≥“Ø–π: ${a}`;if(401===a||401===t)throw new Error("Token —Ö“Ø—á–∏–Ω–≥“Ø–π —ç—Å–≤—ç–ª —Ö—É–≥–∞—Ü–∞–∞ –Ω—å –¥—É—É—Å—Å–∞–Ω –±–∞–π–Ω–∞. –î–∞—Ö–∏–Ω –Ω—ç–≤—Ç—ç—Ä–Ω—ç “Ø“Ø.");if(404===a||404===t)throw new Error(`–î–∞—Ç–∞ –æ–ª–¥—Å–æ–Ω–≥“Ø–π: ${r}`);if(400===a||400===t)throw new Error(`–ê–ª–¥–∞–∞—Ç–∞–π —Ö“Ø—Å—ç–ª—Ç: ${r}`);throw new Error(r)}async function m(e,n){return await Excel.run((async t=>{t.workbook.settings.set(e,n),await t.sync()}))}},5209:function(e,n,t){t.r(n);var a=t(6540),r=t(4541),o=t(2558),l=t(4956),i=t(2766),s=t(333),u=t(8310),c=t(6230),f=t(6427),m=t(5793),p=t(7394),d=t(2471),v=t(5127),w=t(9023),g=t(419),b=t(3161),y=t(3894),h=t(6725),k=t(927),E=t(9027);const _=(0,r.n)({container:{flexGrow:1,padding:"20px",backgroundColor:o.L.colorNeutralBackground1,minHeight:"100vh"},tabList:{marginBottom:"16px"},table:{width:"100%",marginBottom:"16px",tableLayout:"auto",overflowX:"auto"},input:{minWidth:"50px",maxWidth:"150px"},valueCell:{wordBreak:"break-word",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"},newRow:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"10px",alignItems:"flex-end"},actionCell:{display:"flex",justifyContent:"center",alignItems:"center",gap:"6px"},actionButton:{padding:"6px",borderRadius:"6px",backgroundColor:o.L.colorBrandBackground,color:"white",border:"none",cursor:"pointer",transition:"all 0.2s ease-in-out"},actionButtonHover:{backgroundColor:o.L.colorBrandBackgroundHover}});n.default=({isSidebarOpen:e})=>{const n=_(),[t,r]=(0,a.useState)([]),[o,x]=(0,a.useState)([]),[C,$]=(0,a.useState)(""),[T,I]=(0,a.useState)(null),[S,N]=(0,a.useState)({name:"",value:""}),[P,j]=(0,a.useState)({name:"",value:""}),[B,L]=(0,a.useState)(!1),{showMessage:M,setLoading:A}=(0,h.U)();(0,a.useEffect)((()=>{fetch(`${E.C}/api/settings`).then((e=>e.json())).then((e=>{r(e);const n=[...new Set(e.map((e=>e.tab)))];x(n),$(n[0]||"")})).catch((e=>console.error("‚ö†Ô∏è settings.json API —É–Ω—à–∏—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞",e)))}),[]);const R=t.filter((e=>e.tab===C));return a.createElement("div",{className:n.container,style:{marginLeft:e?250:50,transition:"margin-left 0.3s ease-in-out"}},a.createElement("h2",null,"üìã ",C),a.createElement(l.w,{selectedValue:C,onTabSelect:(e,n)=>$(n.value),className:n.tabList},o.map((e=>a.createElement(i.o,{key:e,value:e},e)))),a.createElement(s.X,{className:n.table},a.createElement(u.A,null,a.createElement(c.H,null,a.createElement(f.M,null,"–ù—ç—Ä"),a.createElement(f.M,null,"–£—Ç–≥–∞"),a.createElement(f.M,null,"“Æ–π–ª–¥—ç–ª"))),a.createElement(m.B,null,R.map((e=>{return a.createElement(c.H,{key:e.id},a.createElement(p.n,null,T===e.id?a.createElement(d.p,{size:"small",value:S.name,readOnly:!0,className:n.input,style:{backgroundColor:"#f9f9f9",color:"#666"}}):e.name),a.createElement(p.n,{className:n.valueCell},T===e.id?a.createElement(d.p,{size:"small",value:S.value,onChange:(e,n)=>N({...S,value:n.value}),className:n.input}):(o=e.name,["khanbank_password","access_token","device_token","refresh_token","car_token"].includes(o)?a.createElement("span",{title:"Hidden"},"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"):a.createElement("span",{title:e.value},e.value.length>35?e.value.slice(0,35)+"‚Ä¶":e.value))),a.createElement(p.n,{className:n.actionCell},T===e.id?a.createElement(a.Fragment,null,a.createElement(v.m,{content:"–•–∞–¥–≥–∞–ª–∞—Ö"},a.createElement(w.$,{appearance:"subtle",size:"small",icon:a.createElement(g.qep,null),onClick:()=>(async e=>(0,k.$A)(A,M,(async()=>{const n=t.map((n=>n.id===e?{...n,value:S.value,update_date:(new Date).toISOString()}:n));r(n);const a=await fetch(`${E.C}/api/settings/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:S.value})}),o=await a.json();if(!a.ok)throw new Error(o.message||"–°–µ—Ä–≤–µ—Ä–∏–π–Ω –∞–ª–¥–∞–∞");I(null),M("‚úÖ –¢–æ—Ö–∏—Ä–≥–æ–æ –∞–º–∂–∏–ª—Ç—Ç–∞–π —Ö–∞–¥–≥–∞–ª–∞–≥–¥–ª–∞–∞")})))(e.id)})),a.createElement(v.m,{content:"–ë–æ–ª–∏—Ö"},a.createElement(w.$,{appearance:"subtle",size:"small",icon:a.createElement(b.rsL,null),onClick:()=>I(null)}))):a.createElement(v.m,{content:"–ó–∞—Å–∞—Ö"},a.createElement(w.$,{appearance:"subtle",size:"small",icon:a.createElement(y.$AA,null),onClick:()=>(e=>{I(e.id),N({name:e.name,value:e.value})})(e),className:n.actionButton}))));var o})))),a.createElement(w.$,{appearance:"secondary",onClick:()=>L(!B)},B?"‚ùå –ë–æ–ª–∏—Ö":"‚ûï –®–∏–Ω—ç —Ç–æ—Ö–∏—Ä–≥–æ–æ"),B&&a.createElement("div",{className:n.newRow},a.createElement(d.p,{placeholder:"–ù—ç—Ä",value:P.name,onChange:(e,n)=>j({...P,name:n.value}),className:n.input}),a.createElement(d.p,{placeholder:"–£—Ç–≥–∞",value:P.value,onChange:(e,n)=>j({...P,value:n.value}),className:n.input}),a.createElement(w.$,{appearance:"primary",onClick:async()=>{if(P.name.trim()&&P.value.trim())return(0,k.$A)(A,M,(async()=>{const e=await fetch(`${E.C}/api/settings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...P,tab:C})}),n=await e.json();if(!e.ok)throw new Error(n.message||"–°–µ—Ä–≤–µ—Ä–∏–π–Ω –∞–ª–¥–∞–∞");r((e=>[...e,n.data])),j({name:"",value:""}),L(!1),M("‚úÖ –®–∏–Ω—ç —Ç–æ—Ö–∏—Ä–≥–æ–æ –Ω—ç–º—ç–≥–¥–ª—ç—ç")}));M("‚ö†Ô∏è –ù—ç—Ä –±–æ–ª–æ–Ω —É—Ç–≥–∞ —à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π")}},"–•–∞–¥–≥–∞–ª–∞—Ö")))}},7463:function(e,n){function t(e,n){var t=e.length;e.push(n);e:for(;0<t;){var a=t-1>>>1,r=e[a];if(!(0<o(r,n)))break e;e[a]=n,e[t]=r,t=a}}function a(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var n=e[0],t=e.pop();if(t!==n){e[0]=t;e:for(var a=0,r=e.length,l=r>>>1;a<l;){var i=2*(a+1)-1,s=e[i],u=i+1,c=e[u];if(0>o(s,t))u<r&&0>o(c,s)?(e[a]=c,e[u]=t,a=u):(e[a]=s,e[i]=t,a=i);else{if(!(u<r&&0>o(c,t)))break e;e[a]=c,e[u]=t,a=u}}}return n}function o(e,n){var t=e.sortIndex-n.sortIndex;return 0!==t?t:e.id-n.id}if("object"==typeof performance&&"function"==typeof performance.now){var l=performance;n.unstable_now=function(){return l.now()}}else{var i=Date,s=i.now();n.unstable_now=function(){return i.now()-s}}var u=[],c=[],f=1,m=null,p=3,d=!1,v=!1,w=!1,g="function"==typeof setTimeout?setTimeout:null,b="function"==typeof clearTimeout?clearTimeout:null,y="undefined"!=typeof setImmediate?setImmediate:null;function h(e){for(var n=a(c);null!==n;){if(null===n.callback)r(c);else{if(!(n.startTime<=e))break;r(c),n.sortIndex=n.expirationTime,t(u,n)}n=a(c)}}function k(e){if(w=!1,h(e),!v)if(null!==a(u))v=!0,B(E);else{var n=a(c);null!==n&&L(k,n.startTime-e)}}function E(e,t){v=!1,w&&(w=!1,b($),$=-1),d=!0;var o=p;try{for(h(t),m=a(u);null!==m&&(!(m.expirationTime>t)||e&&!S());){var l=m.callback;if("function"==typeof l){m.callback=null,p=m.priorityLevel;var i=l(m.expirationTime<=t);t=n.unstable_now(),"function"==typeof i?m.callback=i:m===a(u)&&r(u),h(t)}else r(u);m=a(u)}if(null!==m)var s=!0;else{var f=a(c);null!==f&&L(k,f.startTime-t),s=!1}return s}finally{m=null,p=o,d=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,x=!1,C=null,$=-1,T=5,I=-1;function S(){return!(n.unstable_now()-I<T)}function N(){if(null!==C){var e=n.unstable_now();I=e;var t=!0;try{t=C(!0,e)}finally{t?_():(x=!1,C=null)}}else x=!1}if("function"==typeof y)_=function(){y(N)};else if("undefined"!=typeof MessageChannel){var P=new MessageChannel,j=P.port2;P.port1.onmessage=N,_=function(){j.postMessage(null)}}else _=function(){g(N,0)};function B(e){C=e,x||(x=!0,_())}function L(e,t){$=g((function(){e(n.unstable_now())}),t)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(e){e.callback=null},n.unstable_continueExecution=function(){v||d||(v=!0,B(E))},n.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return a(u)},n.unstable_next=function(e){switch(p){case 1:case 2:case 3:var n=3;break;default:n=p}var t=p;p=n;try{return e()}finally{p=t}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(e,n){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var t=p;p=e;try{return n()}finally{p=t}},n.unstable_scheduleCallback=function(e,r,o){var l=n.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?l+o:l,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:f++,callback:r,priorityLevel:e,startTime:o,expirationTime:i=o+i,sortIndex:-1},o>l?(e.sortIndex=o,t(c,e),null===a(u)&&e===a(c)&&(w?(b($),$=-1):w=!0,L(k,o-l))):(e.sortIndex=i,t(u,e),v||d||(v=!0,B(E))),e},n.unstable_shouldYield=S,n.unstable_wrapCallback=function(e){var n=p;return function(){var t=p;p=n;try{return e.apply(this,arguments)}finally{p=t}}}},9027:function(e,n,t){t.d(n,{C:function(){return a}});const a="undefined"!=typeof window&&window.__XFINANCE_API_URL||"https://medchij-xfinance.vercel.app".replace(/\/+$/,"")},9982:function(e,n,t){e.exports=t(7463)}}]);
//# sourceMappingURL=page-settings.js.map