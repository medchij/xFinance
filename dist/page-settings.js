/*! For license information please see page-settings.js.LICENSE.txt */
"use strict";(self.webpackChunkxfinance=self.webpackChunkxfinance||[]).push([[60],{927:function(e,n,t){t.d(n,{$A:function(){return r},CN:function(){return i},Ij:function(){return s},M5:function(){return o},kB:function(){return d},rj:function(){return u},sz:function(){return c},t5:function(){return l},tv:function(){return f}});var a=t(9027);async function r(e,n,t){try{e(!0);const n=await t();if(n?.response instanceof Response&&(console.log("üì° HTTP:",n.response.statusText+" "+n.response.status),!n.response.ok)){const e=await n.response.text();throw new Error("‚ùå –°–µ—Ä–≤–µ—Ä–∏–π–Ω –∞–ª–¥–∞–∞: "+e)}return n}catch(e){throw n("‚ùå –ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞: "+(e?.message||e)),console.error("API Error:",e?.message||e),e}finally{e(!1)}}async function o(){const e=await fetch(`${a.C}/api/settings`);if(!e.ok)throw new Error("‚ö†Ô∏è Settings.json —Ç–∞—Ç–∞–∂ —á–∞–¥—Å–∞–Ω–≥“Ø–π");return await e.json()}function i(e,n){return e.find((e=>e.name===n))?.value||""}function s(e,n){return e.find((e=>e.name===n))?.id||""}function l(e,n){if(!e||"number"!=typeof e&&"string"!=typeof e)throw new Error(`üìÖ ${n} –Ω“Ø–¥—ç–Ω–¥ –æ–≥–Ω–æ–æ –æ—Ä—É—É–ª–Ω–∞ —É—É (2025-01-30 —ç—Å–≤—ç–ª Excel –æ–≥–Ω–æ–æ–Ω—ã format)`);if("number"==typeof e){const n=new Date(1899,11,30);e=new Date(n.getTime()+864e5*e).toISOString().split("T")[0]}if("string"==typeof e&&!/^\d{4}-\d{2}-\d{2}$/.test(e))throw new Error(`üìÖ ${n} –±—É—Ä—É—É –±–∞–π–Ω–∞. YYYY-MM-DD —Ö—ç–ª–±—ç—Ä—Ç—ç–π –±–∞–π–≤–∞–ª –∑–æ—Ö–∏–º–∂—Ç–æ–π.`);return e.toString().trim()}function c(e){return"number"==typeof e&&e.toString().length>15?"'"+e.toString():"string"==typeof e&&/^\d{16,}$/.test(e)?"'"+e:e}async function u(e,n=14){try{await Excel.run((async t=>{const a=t.workbook.worksheets.getActiveWorksheet(),r=a.getUsedRange();r.load(["rowCount","columnCount"]),await t.sync();const o=r.rowCount,i=Math.max(0,r.columnCount-(n||0));console.log(`üìä –•—ç—Ä—ç–≥–ª—ç–≥–¥—ç–∂ –±—É–π –º—É–∂: ${o} –º”©—Ä, ${i} –±–∞–≥–∞–Ω–∞ (–±–∞—Ä—É—É–Ω–∞–∞—Å –∞–ª–≥–∞—Å—Å–∞–Ω: ${n})`);for(let e=0;e<i;e++){const n=a.getRangeByIndexes(0,e,o,1);n.load("values"),await t.sync(),n.values.flat().every((e=>null===e||""===e))&&(n.columnHidden=!0)}await t.sync(),e&&e("‚úÖ –•–æ–æ—Å–æ–Ω –±–∞–≥–∞–Ω—É—É–¥ –∞–º–∂–∏–ª—Ç—Ç–∞–π –Ω—É—É–∂ –¥—É—É—Å–ª–∞–∞.")}))}catch(n){console.error("‚ùå –•–æ–æ—Å–æ–Ω –±–∞–≥–∞–Ω–∞ –Ω—É—É—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞:",n),e&&e("‚ùå –ê–ª–¥–∞–∞: "+n.message)}}function f(e,n){const t=n?.status?.code,a=e.status,r=n?.status?.message||n?.message||n?.error||`–°–µ—Ä–≤–µ—Ä–∏–π–Ω —Ö–∞—Ä–∏—É –∞–º–∂–∏–ª—Ç–≥“Ø–π: ${a}`;if(401===a||401===t)throw new Error("Token —Ö“Ø—á–∏–Ω–≥“Ø–π —ç—Å–≤—ç–ª —Ö—É–≥–∞—Ü–∞–∞ –Ω—å –¥—É—É—Å—Å–∞–Ω –±–∞–π–Ω–∞. –î–∞—Ö–∏–Ω –Ω—ç–≤—Ç—ç—Ä–Ω—ç “Ø“Ø.");if(404===a||404===t)throw new Error(`–î–∞—Ç–∞ –æ–ª–¥—Å–æ–Ω–≥“Ø–π: ${r}`);if(400===a||400===t)throw new Error(`–ê–ª–¥–∞–∞—Ç–∞–π —Ö“Ø—Å—ç–ª—Ç: ${r}`);throw new Error(r)}async function d(e,n){return await Excel.run((async t=>{t.workbook.settings.set(e,n),await t.sync()}))}},5209:function(e,n,t){t.r(n);var a=t(6540),r=t(4541),o=t(2558),i=t(4956),s=t(2766),l=t(333),c=t(8310),u=t(6230),f=t(6427),d=t(5793),p=t(7394),h=t(2471),m=t(5127),w=t(9023),v=t(419),g=t(3161),b=t(3894),x=t(6725),y=t(927),k=t(9027),j=t(4848);const C=(0,r.n)({container:{flexGrow:1,padding:"20px",backgroundColor:o.L.colorNeutralBackground1,minHeight:"100vh"},tabList:{marginBottom:"16px"},table:{width:"100%",marginBottom:"16px",tableLayout:"auto",overflowX:"auto"},input:{minWidth:"50px",maxWidth:"150px"},valueCell:{wordBreak:"break-word",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"},newRow:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"10px",alignItems:"flex-end"},actionCell:{display:"flex",justifyContent:"center",alignItems:"center",gap:"6px"},actionButton:{padding:"6px",borderRadius:"6px",backgroundColor:o.L.colorBrandBackground,color:"white",border:"none",cursor:"pointer",transition:"all 0.2s ease-in-out"},actionButtonHover:{backgroundColor:o.L.colorBrandBackgroundHover}});n.default=({isSidebarOpen:e})=>{const n=C(),[t,r]=(0,a.useState)([]),[o,_]=(0,a.useState)([]),[$,T]=(0,a.useState)(""),[I,S]=(0,a.useState)(null),[N,E]=(0,a.useState)({name:"",value:""}),[P,B]=(0,a.useState)({name:"",value:""}),[L,M]=(0,a.useState)(!1),{showMessage:A,setLoading:R}=(0,x.U)();(0,a.useEffect)((()=>{fetch(`${k.C}/api/settings`).then((e=>e.json())).then((e=>{r(e);const n=[...new Set(e.map((e=>e.tab)))];_(n),T(n[0]||"")})).catch((e=>console.error("‚ö†Ô∏è settings.json API —É–Ω—à–∏—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞",e)))}),[]);const H=t.filter((e=>e.tab===$));return(0,j.jsxs)("div",{className:n.container,style:{marginLeft:e?250:50,transition:"margin-left 0.3s ease-in-out"},children:[(0,j.jsxs)("h2",{children:["üìã ",$]}),(0,j.jsx)(i.w,{selectedValue:$,onTabSelect:(e,n)=>T(n.value),className:n.tabList,children:o.map((e=>(0,j.jsx)(s.o,{value:e,children:e},e)))}),(0,j.jsxs)(l.X,{className:n.table,children:[(0,j.jsx)(c.A,{children:(0,j.jsxs)(u.H,{children:[(0,j.jsx)(f.M,{children:"–ù—ç—Ä"}),(0,j.jsx)(f.M,{children:"–£—Ç–≥–∞"}),(0,j.jsx)(f.M,{children:"“Æ–π–ª–¥—ç–ª"})]})}),(0,j.jsx)(d.B,{children:H.map((e=>{return(0,j.jsxs)(u.H,{children:[(0,j.jsx)(p.n,{children:I===e.id?(0,j.jsx)(h.p,{size:"small",value:N.name,readOnly:!0,className:n.input,style:{backgroundColor:"#f9f9f9",color:"#666"}}):e.name}),(0,j.jsx)(p.n,{className:n.valueCell,children:I===e.id?(0,j.jsx)(h.p,{size:"small",value:N.value,onChange:(e,n)=>E({...N,value:n.value}),className:n.input}):(a=e.name,["khanbank_password","access_token","device_token","refresh_token","car_token"].includes(a)?(0,j.jsx)("span",{title:"Hidden",children:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"}):(0,j.jsx)("span",{title:e.value,children:e.value.length>35?e.value.slice(0,35)+"‚Ä¶":e.value}))}),(0,j.jsx)(p.n,{className:n.actionCell,children:I===e.id?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(m.m,{content:"–•–∞–¥–≥–∞–ª–∞—Ö",children:(0,j.jsx)(w.$,{appearance:"subtle",size:"small",icon:(0,j.jsx)(v.qep,{}),onClick:()=>(async e=>(0,y.$A)(R,A,(async()=>{const n=t.map((n=>n.id===e?{...n,value:N.value,update_date:(new Date).toISOString()}:n));r(n);const a=await fetch(`${k.C}/api/settings/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:N.value})}),o=await a.json();if(!a.ok)throw new Error(o.message||"–°–µ—Ä–≤–µ—Ä–∏–π–Ω –∞–ª–¥–∞–∞");S(null),A("‚úÖ –¢–æ—Ö–∏—Ä–≥–æ–æ –∞–º–∂–∏–ª—Ç—Ç–∞–π —Ö–∞–¥–≥–∞–ª–∞–≥–¥–ª–∞–∞")})))(e.id)})}),(0,j.jsx)(m.m,{content:"–ë–æ–ª–∏—Ö",children:(0,j.jsx)(w.$,{appearance:"subtle",size:"small",icon:(0,j.jsx)(g.rsL,{}),onClick:()=>S(null)})})]}):(0,j.jsx)(m.m,{content:"–ó–∞—Å–∞—Ö",children:(0,j.jsx)(w.$,{appearance:"subtle",size:"small",icon:(0,j.jsx)(b.$AA,{}),onClick:()=>(e=>{S(e.id),E({name:e.name,value:e.value})})(e),className:n.actionButton})})})]},e.id);var a}))})]}),(0,j.jsx)(w.$,{appearance:"secondary",onClick:()=>M(!L),children:L?"‚ùå –ë–æ–ª–∏—Ö":"‚ûï –®–∏–Ω—ç —Ç–æ—Ö–∏—Ä–≥–æ–æ"}),L&&(0,j.jsxs)("div",{className:n.newRow,children:[(0,j.jsx)(h.p,{placeholder:"–ù—ç—Ä",value:P.name,onChange:(e,n)=>B({...P,name:n.value}),className:n.input}),(0,j.jsx)(h.p,{placeholder:"–£—Ç–≥–∞",value:P.value,onChange:(e,n)=>B({...P,value:n.value}),className:n.input}),(0,j.jsx)(w.$,{appearance:"primary",onClick:async()=>{if(P.name.trim()&&P.value.trim())return(0,y.$A)(R,A,(async()=>{const e=await fetch(`${k.C}/api/settings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...P,tab:$})}),n=await e.json();if(!e.ok)throw new Error(n.message||"–°–µ—Ä–≤–µ—Ä–∏–π–Ω –∞–ª–¥–∞–∞");r((e=>[...e,n.data])),B({name:"",value:""}),M(!1),A("‚úÖ –®–∏–Ω—ç —Ç–æ—Ö–∏—Ä–≥–æ–æ –Ω—ç–º—ç–≥–¥–ª—ç—ç")}));A("‚ö†Ô∏è –ù—ç—Ä –±–æ–ª–æ–Ω —É—Ç–≥–∞ —à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π")},children:"–•–∞–¥–≥–∞–ª–∞—Ö"})]})]})}},7463:function(e,n){function t(e,n){var t=e.length;e.push(n);e:for(;0<t;){var a=t-1>>>1,r=e[a];if(!(0<o(r,n)))break e;e[a]=n,e[t]=r,t=a}}function a(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var n=e[0],t=e.pop();if(t!==n){e[0]=t;e:for(var a=0,r=e.length,i=r>>>1;a<i;){var s=2*(a+1)-1,l=e[s],c=s+1,u=e[c];if(0>o(l,t))c<r&&0>o(u,l)?(e[a]=u,e[c]=t,a=c):(e[a]=l,e[s]=t,a=s);else{if(!(c<r&&0>o(u,t)))break e;e[a]=u,e[c]=t,a=c}}}return n}function o(e,n){var t=e.sortIndex-n.sortIndex;return 0!==t?t:e.id-n.id}if("object"==typeof performance&&"function"==typeof performance.now){var i=performance;n.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();n.unstable_now=function(){return s.now()-l}}var c=[],u=[],f=1,d=null,p=3,h=!1,m=!1,w=!1,v="function"==typeof setTimeout?setTimeout:null,g="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function x(e){for(var n=a(u);null!==n;){if(null===n.callback)r(u);else{if(!(n.startTime<=e))break;r(u),n.sortIndex=n.expirationTime,t(c,n)}n=a(u)}}function y(e){if(w=!1,x(e),!m)if(null!==a(c))m=!0,B(k);else{var n=a(u);null!==n&&L(y,n.startTime-e)}}function k(e,t){m=!1,w&&(w=!1,g($),$=-1),h=!0;var o=p;try{for(x(t),d=a(c);null!==d&&(!(d.expirationTime>t)||e&&!S());){var i=d.callback;if("function"==typeof i){d.callback=null,p=d.priorityLevel;var s=i(d.expirationTime<=t);t=n.unstable_now(),"function"==typeof s?d.callback=s:d===a(c)&&r(c),x(t)}else r(c);d=a(c)}if(null!==d)var l=!0;else{var f=a(u);null!==f&&L(y,f.startTime-t),l=!1}return l}finally{d=null,p=o,h=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var j,C=!1,_=null,$=-1,T=5,I=-1;function S(){return!(n.unstable_now()-I<T)}function N(){if(null!==_){var e=n.unstable_now();I=e;var t=!0;try{t=_(!0,e)}finally{t?j():(C=!1,_=null)}}else C=!1}if("function"==typeof b)j=function(){b(N)};else if("undefined"!=typeof MessageChannel){var E=new MessageChannel,P=E.port2;E.port1.onmessage=N,j=function(){P.postMessage(null)}}else j=function(){v(N,0)};function B(e){_=e,C||(C=!0,j())}function L(e,t){$=v((function(){e(n.unstable_now())}),t)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(e){e.callback=null},n.unstable_continueExecution=function(){m||h||(m=!0,B(k))},n.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return a(c)},n.unstable_next=function(e){switch(p){case 1:case 2:case 3:var n=3;break;default:n=p}var t=p;p=n;try{return e()}finally{p=t}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(e,n){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var t=p;p=e;try{return n()}finally{p=t}},n.unstable_scheduleCallback=function(e,r,o){var i=n.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?i+o:i,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:f++,callback:r,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>i?(e.sortIndex=o,t(u,e),null===a(c)&&e===a(u)&&(w?(g($),$=-1):w=!0,L(y,o-i))):(e.sortIndex=s,t(c,e),m||h||(m=!0,B(k))),e},n.unstable_shouldYield=S,n.unstable_wrapCallback=function(e){var n=p;return function(){var t=p;p=n;try{return e.apply(this,arguments)}finally{p=t}}}},9027:function(e,n,t){t.d(n,{C:function(){return i}});const a="undefined"!=typeof window,r=a&&/^(localhost|127\.0\.0\.1)$/i.test(window.location.hostname),o="undefined"!=typeof process?"https://medchij-xfinance.vercel.app":"",i=r?"http://localhost:4000":window.__XFINANCE_API_URL||(o?o.replace(/\/+$/,""):a?window.location.origin:"")},9982:function(e,n,t){e.exports=t(7463)}}]);
//# sourceMappingURL=page-settings.js.map