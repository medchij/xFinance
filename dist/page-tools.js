"use strict";(self.webpackChunkxfinance=self.webpackChunkxfinance||[]).push([[472],{1404:function(e,t,n){n.r(t),n.d(t,{default:function(){return oe}});var a=n(6540),o=n(5127),s=n(9023),r=n(72),i=n(927),l=n(9027);async function c(e,t){return(0,i.$A)(t,e,(async()=>{e("üîê Access token –∞–≤—á –±–∞–π–Ω–∞...");const t=await(0,i.M5)(),n=(0,i.CN)(t,"khanbank_username"),a=(0,i.CN)(t,"khanbank_password"),o=(0,i.CN)(t,"device_token"),s=(0,i.CN)(t,"device-id"),r=(0,i.Ij)(t,"access_token"),c=(0,i.Ij)(t,"refresh_token");if(!(n&&a&&o&&r&&c&&s))throw new Error("‚ö†Ô∏è Settings.json –¥—ç—ç—Ä —à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π –º—ç–¥—ç—ç–ª—ç–ª –¥—É—Ç—É—É –±–∞–π–Ω–∞");const d=new Headers;d.append("Origin","https://corp.khanbank.com"),d.append("Referer","https://corp.khanbank.com/"),d.append("Host","api.khanbank.com:9003"),d.append("Authorization",o),d.append("Device-id",s),d.append("Content-Type","application/json"),d.append("Cookie","__uzma=20418a7f-ce91-e5c8-6225-bc7b412e9039; __uzmb=1747732417; __uzmc=5803638828705; __uzmd=1747962735; __uzme=0783");const u=JSON.stringify({grant_type:"password",username:n,password:a,channelId:"I"}),p=await fetch("https://api.khanbank.com:9003/v3/auth/token?grant_type=password",{method:"POST",headers:d,body:u,redirect:"follow"}),h=await p.json();return p.ok||(0,i.tv)(p,h),e("‚úÖ Token –∞–º–∂–∏–ª—Ç—Ç–∞–π –∞–≤–ª–∞–∞."),await fetch(`${l.C}/api/settings/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:h.access_token})}),await fetch(`${l.C}/api/settings/${c}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:h.refresh_token})}),{result:h,response:p}}))}function d(e){const t=Number(e);return isNaN(t)?"":t<=0?"–•—É–≥–∞—Ü–∞–∞–≥“Ø–π":t<=30?"1 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":t<=90?"1-3 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":t<=180?"3-6 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":t<=365?"6-12 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":t<=1095?"12-36 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":t<=1825?"36-60 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":"60-—Å –¥—ç—ç—à —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π"}async function u(e,t,n){const a=e.getUsedRange();a.load("values"),await e.context.sync();const o=a.values,s=[...new Set(o.slice(5).map((e=>e[t[n]])).filter(Boolean))];["81","–ú”®–ù–ì”®–ù –î“Æ–ù","TOO","–•–≠–í–ò–ô–ù","–•–£–ì–ê–¶–ê–ê –•–≠–¢–≠–†–°–≠–ù","–ß–ê–ù–ê–†–ì“Æ–ô","–î–≠–≠–î –•“Æ“Æ","–î–û–û–î –•“Æ“Æ","<>81","–ú”®–ù–ì”®–ù –î“Æ–ù","TOO","–•–≠–í–ò–ô–ù","–•–£–ì–ê–¶–ê–ê –•–≠–¢–≠–†–°–≠–ù","–ß–ê–ù–ê–†–ì“Æ–ô","–î–≠–≠–î –•“Æ“Æ","–î–û–û–î –•“Æ“Æ"].forEach(((t,n)=>e.getCell(0,63+n).values=[[t]]));const r=await f(e,63),i=(e,a,s=!1)=>{const r=o.filter((o=>{const r=(o[t.SEGMENT1]||"").toString().trim();return o[t[n]]===e&&(s?r!==a:r===a)})),i=e=>r.filter((n=>(n[t.ANGILAL1]||"").toString().trim()===e)).reduce(((e,n)=>e+(+n[t["“Æ–ù–î–°–≠–ù –ó–≠–≠–õ"]]||0)),0),l=r.reduce(((e,n)=>e+(+n[t["“Æ–ù–î–°–≠–ù –ó–≠–≠–õ"]]||0)),0),c=r.map((e=>+e[t["–•“Æ“Æ–ù–ò–ô –•–£–í–¨"]])).filter((e=>!isNaN(e)));return[l,new Set(r.map((e=>e["–ê–ù–ì–ò–õ–ê–õ"===n?t["–î–ê–ù–°–ù–´ –î–£–ì–ê–ê–†"]:t["–†–î"]])).filter(Boolean)).size,i("–•–≠–í–ò–ô–ù"),i("–•–£–ì–ê–¶–ê–ê –•–≠–¢–≠–†–°–≠–ù"),i("–ß–ê–ù–ê–†–ì“Æ–ô"),c.length?Math.max(...c)/1200:"",c.length?Math.min(...c)/1200:""]};s.forEach(((t,n)=>{const a=r+n;e.getCell(a,63).values=[[t]],[...i(t,"81"),"",...i(t,"81",!0)].forEach(((t,n)=>e.getCell(a,64+n).values=[[t]]))})),await e.context.sync()}async function p(e,t,n,a=!0){const o=e.getUsedRange();o.load("values"),await e.context.sync();const s=o.values,r=[...new Set(s.slice(5).map((e=>e[t[n]])).filter(Boolean))];["81","–ú”®–ù–ì”®–ù –î“Æ–ù","TOO","–ñ–î–•","–î–≠–≠–î –•“Æ“Æ","–î–û–û–î –•“Æ“Æ","<>81","–ú”®–ù–ì”®–ù –î“Æ–ù","TOO","–ñ–î–•","–î–≠–≠–î –•“Æ“Æ","–î–û–û–î –•“Æ“Æ"].forEach(((t,n)=>e.getCell(0,63+n).values=[[t]]));const i=await f(e,63),l=(e,o,r=!1)=>{const i=s.filter((s=>{const i=s[t[n]];if(!a)return i===e;const l=(s[t.SEGMENT1]||"").toString().trim();return i===e&&(r?l!==o:l===o)})),l=i.reduce(((e,n)=>e+(+n[t["–û–õ–ì–û–°–û–ù –î“Æ–ù"]]||0)),0),c=i.reduce(((e,n)=>e+(+n[t.JDH_DUN]||0)),0),d=i.map((e=>+e[t["–•“Æ“Æ"]])).filter((e=>!isNaN(e)));return[l,new Set(i.map((e=>e[t["–†–ï–ì–ò–°–¢–ï–†"]])).filter(Boolean)).size,l>0?c/l/12:0,d.length?Math.max(...d)/1200:"",d.length?Math.min(...d)/1200:""]};r.forEach(((t,n)=>{const o=i+n;e.getCell(o,63).values=[[t]],(a?[...l(t,"81"),"",...l(t,"81",!0)]:[...l(t)]).forEach(((t,n)=>e.getCell(o,64+n).values=[[t]]))})),await e.context.sync()}async function h(e,t,n,a=!0){const o=e.getUsedRange();o.load("values"),await e.context.sync();const s=o.values,r=[...new Set(s.slice(5).map((e=>e[t[n]])).filter(Boolean))];["81","–ú”®–ù–ì”®–ù –î“Æ–ù","TOO","<>81","–ú”®–ù–ì”®–ù –î“Æ–ù","TOO"].forEach(((t,n)=>e.getCell(0,63+n).values=[[t]]));const i=await f(e,63),l=(e,o,r=!1)=>{const i=s.filter((s=>{const i=s[t[n]];if(!a)return i===e;const l=(s[t["–°–ï–ì–ú–ï–ù–¢"]]||"").toString().trim();return i===e&&(r?l!==o:l===o)}));return[i.reduce(((e,n)=>e+(+n[t["–ó–≠–≠–õ"]]||0)),0),new Set(i.map((e=>e[t["–î–ê–ù–°"]])).filter(Boolean)).size]};r.forEach(((t,n)=>{const o=i+n;e.getCell(o,63).values=[[t]],(a?[...l(t,"81"),"",...l(t,"81",!0)]:[...l(t)]).forEach(((t,n)=>e.getCell(o,64+n).values=[[t]]))})),await e.context.sync()}async function x(e){if(!e)throw new Error("‚ùå Sheet is undefined.");const t=e.getUsedRange();t.load("address"),await e.context.sync(),t.unmerge(),await e.context.sync()}async function g(e){const t=e.getRange("A5:CO5");t.load("values"),await e.context.sync();const n={};return t.values[0].forEach(((e,t)=>{e&&(n[e.toString().trim()]=t)})),n}function w(e){const t=Math.floor(e-25569);return new Date(86400*t*1e3)}async function f(e,t){const n=e.getUsedRange();n.load("rowCount"),await e.context.sync();const a=e.getRangeByIndexes(0,t,n.rowCount,1);a.load("values"),await e.context.sync();const o=a.values.map((e=>e[0]));for(let e=o.length-1;e>=0;e--)if(null!==o[e]&&""!==o[e])return e+1;return 0}var m=n(4848),y=n(6964).Promise;const v={overlay:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.3)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modal:{width:"600px",maxHeight:"90vh",overflowY:"auto",background:"#fff",padding:"20px",borderRadius:"5px",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column"},title:{fontSize:"18px",marginBottom:"15px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},successMessage:{backgroundColor:"#e0ffe0",color:"#2d862d",padding:"8px",borderRadius:"4px",marginBottom:"10px",textAlign:"center"},row:{display:"flex",flexDirection:"column",marginBottom:"10px"},input:{padding:"8px",fontSize:"14px",border:"1px solid #ccc",borderRadius:"4px",width:"100%",boxSizing:"border-box"},buttonRow:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"15px"},submitButton:{background:"#7367f0",color:"#fff",border:"none",padding:"10px 15px",cursor:"pointer",borderRadius:"4px"},cancelButton:{background:"#ccc",border:"none",padding:"10px 15px",cursor:"pointer",borderRadius:"4px"}};var b=({isOpen:e,onClose:t})=>{const[n,o]=(0,a.useState)(""),[s,r]=(0,a.useState)(""),[i,c]=(0,a.useState)(""),[d,u]=(0,a.useState)("MNT"),[p,h]=(0,a.useState)([]),[x,g]=(0,a.useState)([]),[w,f]=(0,a.useState)([]),[b,j]=(0,a.useState)("");return(0,a.useEffect)((()=>{(async()=>{try{const[e,t]=await y.all([fetch(`${l.C}/api/glcategory`),fetch(`${l.C}/api/currency`)]);if(!e.ok||!t.ok)throw new Error("–°–µ—Ä–≤–µ—Ä—ç—ç—Å –∞–º–∂–∏–ª—Ç–≥“Ø–π —Ö–∞—Ä–∏—É –∏—Ä–ª—ç—ç.");const[n,a]=await y.all([e.json(),t.json()]);h(Array.isArray(n)?n:[]),f(Array.isArray(a)?a:[])}catch(e){console.error("Reference fetch error:",e)}})()}),[]),(0,a.useEffect)((()=>{if(!i)return g([]),r(""),void o("");(async()=>{try{const e=await fetch(`${l.C}/api/glaccount`);if(!e.ok)throw new Error("GLAccount —Ç–∞—Ç–∞—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞.");const t=await e.json(),n=(Array.isArray(t)?t:[]).filter((e=>e["–î–∞–Ω—Å–Ω—ã –∞–Ω–≥–∏–ª–∞–ª"]===i));g(n),r(""),o("")}catch(e){console.error("GLAccount fetch error:",e)}})()}),[i]),e?(0,m.jsx)("div",{style:v.overlay,children:(0,m.jsxs)("div",{style:v.modal,children:[(0,m.jsx)("h2",{style:v.title,children:"–ï—Ä”©–Ω—Ö–∏–π –¥—ç–≤—Ç—ç—Ä “Ø“Ø—Å–≥—ç—Ö"}),b&&(0,m.jsx)("div",{style:v.successMessage,children:b}),(0,m.jsxs)("div",{style:v.row,children:[(0,m.jsx)("label",{children:"–î–∞–Ω—Å–Ω—ã –∞–Ω–≥–∏–ª–∞–ª"}),(0,m.jsxs)("select",{value:i,onChange:e=>c(e.target.value),style:v.input,children:[(0,m.jsx)("option",{value:"",children:"–ê–Ω–≥–∏–ª–∞–ª —Å–æ–Ω–≥–æ—Ö"}),p.map(((e,t)=>(0,m.jsx)("option",{value:e.name,children:e.name},t)))]})]}),(0,m.jsxs)("div",{style:v.row,children:[(0,m.jsx)("label",{children:"–ï–î –¥—É–≥–∞–∞—Ä"}),(0,m.jsxs)("select",{value:s,onChange:e=>{const t=x.find((t=>t["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]===e.target.value));t?(r(t["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]),o(t["–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"])):(r(""),o(""))},style:v.input,disabled:!i,children:[(0,m.jsx)("option",{value:"",children:"–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä —Å–æ–Ω–≥–æ—Ö"}),x.map(((e,t)=>(0,m.jsx)("option",{value:e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"],children:e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]},t)))]})]}),(0,m.jsxs)("div",{style:v.row,children:[(0,m.jsx)("label",{children:"–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"}),(0,m.jsx)("input",{type:"text",value:n,onChange:e=>o(e.target.value),style:v.input})]}),(0,m.jsxs)("div",{style:v.row,children:[(0,m.jsx)("label",{children:"–í–∞–ª—é—Ç"}),(0,m.jsx)("select",{value:d,onChange:e=>u(e.target.value),style:v.input,children:w.map(((e,t)=>(0,m.jsx)("option",{value:e.code,children:e.code},t)))})]}),(0,m.jsxs)("div",{style:v.buttonRow,children:[(0,m.jsx)("button",{style:v.submitButton,onClick:()=>{j("–î–∞–Ω—Å –∞–º–∂–∏–ª—Ç—Ç–∞–π “Ø“Ø—Å–ª—ç—ç!"),setTimeout((()=>j("")),3e3),c(""),r(""),o(""),u("MNT")},children:"–î–∞–Ω—Å “Ø“Ø—Å–≥—ç—Ö"}),(0,m.jsx)("button",{style:v.cancelButton,onClick:t,children:"–ë–æ–ª–∏—Ö"})]})]})}):null},j=n(6725),k=n(6964).Promise;const S={overlay:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.3)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modal:{width:"600px",maxHeight:"90vh",overflowY:"auto",background:"#fff",padding:"20px",borderRadius:"5px",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column"},title:{fontSize:"18px",marginBottom:"15px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},row:{display:"flex",flexDirection:"column",marginBottom:"10px"},input:{padding:"8px",fontSize:"14px",border:"1px solid #ccc",borderRadius:"4px",width:"100%",boxSizing:"border-box"},buttonRow:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"15px"},submitButton:{background:"#7367f0",color:"#fff",border:"none",padding:"10px 15px",cursor:"pointer",borderRadius:"4px"},cancelButton:{background:"#ccc",border:"none",padding:"10px 15px",cursor:"pointer",borderRadius:"4px"}};var E=({isOpen:e,onClose:t})=>{const{showMessage:n,setLoading:o}=(0,j.U)(),[s,r]=(0,a.useState)(""),[i,c]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[p,h]=(0,a.useState)(""),[x,g]=(0,a.useState)(""),[w,f]=(0,a.useState)([]),[y,v]=(0,a.useState)([]),[b,E]=(0,a.useState)([]);(0,a.useEffect)((()=>{(async()=>{try{const[e,t,n]=await k.all([fetch(`${l.C}/api/currency`),fetch(`${l.C}/api/branch`),fetch(`${l.C}/api/glaccount`)]);f(await e.json()),v(await t.json()),E(await n.json())}catch(e){console.error("”®–≥”©–≥–¥”©–ª —Ç–∞—Ç–∞—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞:",e),n("‚ùå ”®–≥”©–≥–¥”©–ª —Ç–∞—Ç–∞—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞")}})()}),[]),(0,a.useEffect)((()=>{if(s&&p&&C(),s){const e=b.find((e=>e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]===s));e&&(c(e["–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"]),u(e["–í–∞–ª—é—Ç"]))}else c(""),u("")}),[s,p,b]);const C=()=>{const e=b.find((e=>e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]===s));if(e&&p){const n=`${e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]}${p}${t=parseInt(e["–¢–æ–æ–ª—É—É—Ä"])+1,t.toString().padStart(4,"0")}`;g(n)}var t};return e?(0,m.jsx)("div",{style:S.overlay,children:(0,m.jsxs)("div",{style:S.modal,children:[(0,m.jsx)("h2",{style:S.title,children:"–î–∞–Ω—Å “Ø“Ø—Å–≥—ç—Ö"}),(0,m.jsxs)("div",{style:S.row,children:[(0,m.jsx)("label",{children:"–ï–î–î"}),(0,m.jsxs)("select",{value:s,onChange:e=>r(e.target.value),style:S.input,children:[(0,m.jsx)("option",{value:"",children:"–ï–î–î —Å–æ–Ω–≥–æ—Ö"}),b.map(((e,t)=>(0,m.jsxs)("option",{value:e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"],children:[e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]," - ",e["–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"]]},t)))]})]}),(0,m.jsxs)("div",{style:S.row,children:[(0,m.jsx)("label",{children:"–°–∞–ª–±–∞—Ä"}),(0,m.jsxs)("select",{value:p,onChange:e=>h(e.target.value),style:S.input,children:[(0,m.jsx)("option",{value:"",children:"–°–∞–ª–±–∞—Ä —Å–æ–Ω–≥–æ—Ö"}),y.map(((e,t)=>(0,m.jsx)("option",{value:e.code,children:e.name},t)))]})]}),(0,m.jsxs)("div",{style:S.row,children:[(0,m.jsx)("label",{children:"–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"}),(0,m.jsx)("input",{type:"text",value:i,placeholder:"–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä—ç—ç –æ—Ä—É—É–ª–Ω–∞ —É—É",onChange:e=>c(e.target.value),style:S.input})]}),(0,m.jsxs)("div",{style:S.row,children:[(0,m.jsx)("label",{children:"–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"}),(0,m.jsx)("input",{type:"text",value:x,readOnly:!0,style:{...S.input,background:"#f9f9f9"}})]}),(0,m.jsxs)("div",{style:S.row,children:[(0,m.jsx)("label",{children:"–í–∞–ª—é—Ç"}),(0,m.jsx)("input",{type:"text",value:d,readOnly:!0,style:{...S.input,background:"#f9f9f9"}})]}),(0,m.jsxs)("div",{style:S.buttonRow,children:[(0,m.jsx)("button",{style:S.submitButton,onClick:async()=>{if(x&&i&&d&&p&&s)try{o(!0);const e=await fetch(`${l.C}/api/account`),t=await e.json();if(t.find((e=>e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]===x)))return void n("‚ö†Ô∏è –ò–∂–∏–ª –¥–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä –∞–ª—å —Ö—ç–¥–∏–π–Ω “Ø“Ø—Å—Å—ç–Ω –±–∞–π–Ω–∞");const a={id:(t.length+1).toString(),"–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä":x,"–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä":i,"–í–∞–ª—é—Ç":d,"–°–∞–ª–±–∞—Ä":y.find((e=>e.code===p))?.name||p,"–ù—ç—ç—Å—ç–Ω –æ–≥–Ω–æ–æ":(new Date).toLocaleString("en-GB")},w=await fetch(`${l.C}/api/account`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),f=await w.json();if(!w.ok)throw new Error(f.message||"–•–∞–¥–≥–∞–ª–∞—Ö “Ø–µ–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞");const m=await fetch(`${l.C}/api/gl-tooluurchange`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({edd:s})}),v=await m.json();if(!m.ok)throw new Error(v.message||"–¢–æ–æ–ª—É—É—Ä —à–∏–Ω—ç—á–ª—ç—Ö—ç–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞");n("‚úÖ –î–∞–Ω—Å –∞–º–∂–∏–ª—Ç—Ç–∞–π “Ø“Ø—Å–ª—ç—ç"),r(""),c(""),u(""),h(""),g("")}catch(e){console.error("–î–∞–Ω—Å “Ø“Ø—Å–≥—ç—Ö—ç–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞:",e),n("‚ùå "+(e.message||"–°–µ—Ä–≤–µ—Ä—Ç—ç–π —Ö–æ–ª–±–æ–≥–¥–æ—Ö–æ–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞"))}finally{o(!1)}else n("‚ö†Ô∏è –ë“Ø—Ö —Ç–∞–ª–±–∞—Ä—ã–≥ –±”©–≥–ª”©–Ω”© “Ø“Ø")},children:"–î–∞–Ω—Å “Ø“Ø—Å–≥—ç—Ö"}),(0,m.jsx)("button",{style:S.cancelButton,onClick:()=>{r(""),c(""),u(""),h(""),g(""),t()},children:"–ë–æ–ª–∏—Ö"})]})]})}):null};const C={overlay:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.3)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modal:{width:"400px",background:"#fff",padding:"20px",borderRadius:"5px",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column"},title:{fontSize:"18px",marginBottom:"15px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},row:{display:"flex",flexDirection:"column",marginBottom:"10px"},input:{padding:"8px",fontSize:"14px",border:"1px solid #ccc",borderRadius:"4px",width:"100%",boxSizing:"border-box"},buttonRow:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"15px"},submitButton:{background:"#7367f0",color:"#fff",border:"none",padding:"10px 15px",cursor:"pointer",borderRadius:"4px"},cancelButton:{background:"#ccc",border:"none",padding:"10px 15px",cursor:"pointer",borderRadius:"4px"}};var N=({isOpen:e,onClose:t})=>{const{showMessage:n,setLoading:o}=(0,j.U)(),[s,r]=(0,a.useState)(""),[i,c]=(0,a.useState)("–ò–¥—ç–≤—Ö–∏—Ç—ç–π");return e?(0,m.jsx)("div",{style:C.overlay,children:(0,m.jsxs)("div",{style:C.modal,children:[(0,m.jsx)("h2",{style:C.title,children:"–•—ç—Ä—ç–≥–ª—ç–≥—á –Ω—ç–º—ç—Ö"}),(0,m.jsxs)("div",{style:C.row,children:[(0,m.jsx)("label",{children:"–ù—ç—Ä"}),(0,m.jsx)("input",{type:"text",value:s,placeholder:"–•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –Ω—ç—Ä –æ—Ä—É—É–ª–Ω–∞ —É—É",onChange:e=>r(e.target.value),style:C.input})]}),(0,m.jsxs)("div",{style:C.row,children:[(0,m.jsx)("label",{children:"–¢”©–ª”©–≤"}),(0,m.jsxs)("select",{value:i,onChange:e=>c(e.target.value),style:C.input,children:[(0,m.jsx)("option",{value:"–ò–¥—ç–≤—Ö–∏—Ç—ç–π",children:"–ò–¥—ç–≤—Ö–∏—Ç—ç–π"}),(0,m.jsx)("option",{value:"–ò–¥—ç–≤—Ö–≥“Ø–π",children:"–ò–¥—ç–≤—Ö–≥“Ø–π"})]})]}),(0,m.jsxs)("div",{style:C.buttonRow,children:[(0,m.jsx)("button",{style:C.submitButton,onClick:async()=>{if(s.trim())try{o(!0);const e=await fetch(`${l.C}/api/customer`);if((await e.json()).find((e=>e.name.toLowerCase()===s.toLowerCase())))return void n("‚ö†Ô∏è –ò–∂–∏–ª –Ω—ç—Ä—Ç—ç–π —Ö–∞—Ä–∏–ª—Ü–∞–≥—á –∞–ª—å —Ö—ç–¥–∏–π–Ω “Ø“Ø—Å—Å—ç–Ω –±–∞–π–Ω–∞");const t=await fetch(`${l.C}/api/customer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:s,status:i})}),a=await t.json();if(!t.ok)throw new Error(a.message||"–•–∞–¥–≥–∞–ª–∞—Ö “Ø–µ–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞");n("‚úÖ –•—ç—Ä—ç–≥–ª—ç–≥—á –∞–º–∂–∏–ª—Ç—Ç–∞–π –Ω—ç–º—ç–≥–¥–ª—ç—ç"),r(""),c("–ò–¥—ç–≤—Ö–∏—Ç—ç–π")}catch(e){console.error("–•—ç—Ä—ç–≥–ª—ç–≥—á –Ω—ç–º—ç—Ö—ç–¥ –∞–ª–¥–∞–∞:",e),n("‚ùå "+(e.message||"–°–µ—Ä–≤–µ—Ä—Ç—ç–π —Ö–æ–ª–±–æ–≥–¥–æ—Ö–æ–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞"))}finally{o(!1)}else n("‚ö†Ô∏è –ù—ç—Ä–∏–π–≥ –æ—Ä—É—É–ª–Ω–∞ —É—É")},children:"–•–∞–¥–≥–∞–ª–∞—Ö"}),(0,m.jsx)("button",{style:C.cancelButton,onClick:()=>{r(""),c("–ò–¥—ç–≤—Ö–∏—Ç—ç–π"),t()},children:"–ë–æ–ª–∏—Ö"})]})]})}):null},A=n(4541),I=n(2558),D=n(2471),T=n(3247),B=n(1419);const U=(0,A.n)({container:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:I.L.colorNeutralBackground1,padding:"10px",overflow:"hidden"},header:{flexShrink:0,paddingBottom:"8px",borderBottom:`1px solid ${I.L.colorNeutralStroke1}`,backgroundColor:I.L.colorNeutralBackground2,zIndex:1},title:{margin:0,fontSize:"16px"},controls:{marginTop:"6px",display:"flex",gap:"6px",alignItems:"center",fontSize:"11px"},logs:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column",paddingTop:"10px"},logItem:{fontFamily:"monospace",fontSize:"12px",whiteSpace:"pre-wrap",wordBreak:"break-word"},messagePanel:{flex:1,marginTop:"10px",display:"flex",flexDirection:"column"},textarea:{height:"40vh",width:"100%"}});var R=()=>{const e=U(),[t,n]=(0,a.useState)([]),[o,r]=(0,a.useState)(""),[i,l]=(0,a.useState)(""),c=(0,a.useRef)(null);(0,a.useEffect)((()=>{(e=>{const t=console.log,n=console.error,a=(t,...n)=>{const a={time:new Date,type:t,message:n.map((e=>"object"==typeof e?JSON.stringify(e):e)).join(" ")};e((e=>[a,...e]))};console.log=(...e)=>{a("log",...e),t(...e)},console.error=(...e)=>{a("error",...e),n(...e)}})(n)}),[]),(0,a.useEffect)((()=>{c.current&&(c.current.scrollTop=0)}),[t]);const d=t.filter((e=>e.message.toLowerCase().includes(i.toLowerCase())));return(0,m.jsxs)("div",{className:e.container,children:[(0,m.jsxs)("div",{className:e.header,children:[(0,m.jsx)("h3",{className:e.title,children:"üìã “Æ–π–ª–¥–ª–∏–π–Ω –ª–æ–≥"}),(0,m.jsxs)("div",{className:e.controls,children:[(0,m.jsx)(D.p,{size:"small",value:i,placeholder:"–•–∞–π—Ö...",onChange:(e,t)=>l(t.value),style:{flex:1}}),(0,m.jsx)(s.$,{size:"small",onClick:()=>{const e=new Blob([d.map((e=>`[${e.time.toLocaleTimeString()}] ${e.message}`)).join("\n")],{type:"text/plain;charset=utf-8"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download="logs.txt",document.body.appendChild(t),t.click(),document.body.removeChild(t)},children:"üì§"})]})]}),(0,m.jsxs)("div",{className:e.logs,ref:c,children:[0===d.length&&(0,m.jsx)("p",{style:{color:"#888"},children:"üïí –•–∞–π–ª—Ç–∞–Ω–¥ —Ç–æ—Ö–∏—Ä—Å–æ–Ω –ª–æ–≥ –æ–ª–¥—Å–æ–Ω–≥“Ø–π."}),d.map(((t,n)=>(0,m.jsxs)("div",{className:e.logItem,style:{color:"error"===t.type?"#cc0000":"#333"},children:["[",t.time.toLocaleTimeString(),"] ",t.message]},n)))]}),(0,m.jsx)("div",{className:e.messagePanel,children:(0,m.jsx)(T.D,{size:"large",label:"üìù Message Panel",children:(0,m.jsx)(B.T,{size:"large",className:e.textarea,value:o,onChange:(e,t)=>r(t.value)})})})]})},_=n(1273),L=n(9013),$=n(7287),z=n(2160),O=n(378),G=n(2316),M=n(2534),H=n(2985),P=n(3161),V=n(2179),W=n(7452),F=n(3894),J=n(4422),Y=n(6779);const q=(e,t)=>{const n=new Date(e);return n.setDate(n.getDate()+t),n};var Z=()=>{const e=new Date,[t,n]=((e=>{const t=new Date(e);t.setMonth(t.getMonth()+-1)})(e),(e=>{const t=new Date(e);t.setFullYear(t.getFullYear()+1)})(e),q(e,-2),q(e,-8),q(e,2),q(e,8),a.useState(new Date)),{setLoading:o,showMessage:s}=(0,j.U)(),i=a.useCallback((async e=>{if(n(e),!(e instanceof Date)||isNaN(e.getTime()))return void s("‚ùå –û–≥–Ω–æ–æ –±—É—Ä—É—É –±–∞–π–Ω–∞.");const t=e.toLocaleDateString("en-CA");await(0,r.ie)(t,s,o)}),[o,s]);return(0,m.jsx)("div",{style:{padding:"20px"},children:(0,m.jsx)(Y.V,{highlightSelectedMonth:!0,onSelectDate:i,value:t||void 0})})};const K=e=>(0,m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:60,height:60,viewBox:"0 0 30 30",...e,children:(0,m.jsx)("path",{d:"M15 3a2 2 0 0 0-.4.043l-.002-.002-9.97 1.994-.001.002A2 2 0 0 0 3 7v16a2 2 0 0 0 1.629 1.965l9.969 1.994A2 2 0 0 0 15 27a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm4 2v3h2v2h-2v2h2v2h-2v2h2v2h-2v2h2v2h-2v3h6a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-6zm4 3h1a1 1 0 0 1 0 2h-1V8zM6.186 10h2.402l1.244 2.99c.101.244.182.527.26.848h.033c.045-.193.134-.486.27-.871L11.785 10h2.188l-2.614 4.955 2.692 5.043h-2.334l-1.504-3.258c-.057-.115-.124-.347-.18-.668h-.021a7.783 7.783 0 0 1-.203.696L8.295 20H5.949l2.783-5.006L6.186 10zM23 12h1a1 1 0 0 1 0 2h-1v-2zm0 4h1a1 1 0 0 1 0 2h-1v-2zm0 4h1a1 1 0 0 1 0 2h-1v-2z"})}),Q=e=>(0,m.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:500,height:476,viewBox:"0 0 375 357",...e,children:[(0,m.jsx)("path",{d:"M104 .6C88.6 3 80.1 5.5 68.5 11.3c-19.3 9.6-35.6 25.9-45.2 45.2-8.1 16.2-10.8 28.1-10.7 47 .2 17.3 2.9 29 10.3 44 4.7 9.4 12.4 20.8 16.8 24.8 2 1.7 2 1.6 2.6-7.7.6-9.5 3.3-24.5 4.6-25.8.3-.4 9 7.6 19.1 17.7L84.5 175 66 193.5c-10.1 10.1-18.7 18.1-19.1 17.7-1.3-1.3-3.9-16.1-4.5-25.8l-.7-9.5-2.9 2.8c-8.2 7.9-17.9 25.5-22.4 40.8-3.2 11.2-4.4 31.2-2.4 43.2 10.9 68.6 85 106.3 147.4 75.2 7.7-3.9 19.5-11.9 22.9-15.7 1.7-1.9 1.5-1.9-6.5-2.6-9.4-.7-25.9-3.5-27-4.5-.4-.4 7.6-9 17.7-19.1l18.5-18.5 11.2 11.2c6.2 6.1 14.7 14.3 18.8 18.1 4.9 4.6 7.2 7.4 6.5 8-1.3 1.3-16.8 4-27.5 4.8l-8.4.7 5.4 4.8c2.9 2.6 8.8 6.8 13 9.4 51.9 31.3 118.2 12.1 145.2-42 7.5-15 10.3-27.4 10.2-46 0-15.8-2-25.6-7.9-39.7-3.8-8.8-12.6-22.7-17.8-27.6l-3.4-3.3-.6 9.4c-.6 9.6-3.3 24.6-4.6 25.9-.3.4-9-7.6-19.1-17.7L289.5 175l18.5-18.5c10.2-10.2 18.8-18.5 19.1-18.5 1.1 0 4 17.3 4.6 27.2l.6 8.9 2.4-2.3c4.3-4 11.9-15 15.8-22.8 15.2-30.3 15.1-63.1-.1-93.5-6.6-13.2-20.3-28.9-32.8-37.4C291.5.1 256.1-4.6 226 5.8c-12.3 4.3-29.2 14.4-35.8 21.5l-2.3 2.4 8.9.6c9.9.6 27.2 3.5 27.2 4.6 0 .3-8.3 8.9-18.5 19.1L187 72.5 168.5 54C158.3 43.8 150 35.3 150 34.9c0-1 17.6-4 27.1-4.6l9-.6-2.8-3c-7.1-7.4-22.6-16.5-36.3-21.2-12.4-4.3-32.2-6.5-43-4.9zm96.2 105.1c6.8 3 13.9 10.2 17.1 17.1 1.7 3.7 2.2 6.6 2.2 13.7 0 8-.3 9.7-3 14.8-5.2 10.4-17.3 18.7-27.3 18.7-23 0-41.3 14.7-45.3 36.3-1.5 8-.2 17.1 3.5 25.2l2.5 5.6-3.1-1.8c-5.5-3.2-17.3-15.6-21.6-22.8-7-11.9-9.4-20.1-9.9-34.5-.6-15 .9-22.6 6.7-34.5 10.8-22.3 31.5-37.1 56.2-40.5 8.6-1.1 15.2-.3 22 2.7zm37.9 18.3c7.1 7.1 9.3 10.1 13.2 18 2.5 5.2 5.3 12.4 6.2 16 2 8.7 1.9 25.6-.1 33.9-8.1 32.9-38.6 56.4-71.3 54.9-15.1-.7-24.3-6.3-30.3-18.6-2.9-5.9-3.3-7.6-3.3-15.2 0-7.3.4-9.3 2.8-14.2 3.5-7.1 11.9-15 18.4-17.3 2.6-.9 9-2 14.1-2.5 21.1-1.9 36.7-15.7 40.4-35.8 1.5-8 .1-16.7-3.8-24.9-1.5-3.2-3-6.2-3.2-6.7-1.4-2.9 9.6 5.2 16.9 12.4z"}),(0,m.jsx)("path",{d:"M182.4 128c-4.7 1.9-6.8 8.5-4.3 13.2.6 1.1 2.6 2.6 4.5 3.4 8.8 3.7 16.5-6.9 10.2-14-2.5-2.9-7.2-4-10.4-2.6zM179.9 206.9c-3.8 3.9-4 8.8-.3 12.5 5.7 5.7 15.4 1.8 15.4-6.1 0-4.6-4.6-9.3-9-9.3-2.2 0-4.1.9-6.1 2.9z"})]});var X=n(8764),ee=n(272);const te={overlay:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.3)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modal:{width:"90%",maxWidth:"1000px",background:"#fff",padding:"20px",borderRadius:"8px",maxHeight:"90vh",overflowY:"auto"},title:{fontSize:"14px",marginBottom:"10px",borderBottom:"1px solid #ddd",paddingBottom:"5px"},tableContainer:{border:"1px solid #ccc",borderRadius:"4px",maxHeight:"70vh",overflow:"auto"},table:{width:"100%",borderCollapse:"collapse",tableLayout:"auto"},th:{background:"#f0f0f0",padding:"8px",border:"1px solid #ccc",fontSize:"12px",position:"sticky",top:0,zIndex:1,whiteSpace:"nowrap"},td:{padding:"6px",border:"1px solid #eee",fontSize:"12px",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},tr:{cursor:"pointer",transition:"background 0.2s"},selectedRow:{background:"#e6f7ff",padding:"8px",marginBottom:"10px",borderRadius:"4px",fontSize:"8px"},undoButton:{background:"#e74c3c",color:"#fff",border:"none",padding:"5px 10px",marginLeft:"10px",cursor:"pointer",borderRadius:"4px"},closeButton:{background:"#ccc",border:"none",padding:"8px 15px",cursor:"pointer",borderRadius:"4px"}};var ne=({isOpen:e,onClose:t})=>{const{setLoading:n,showMessage:o}=(0,j.U)(),[s,l]=(0,a.useState)(""),[c,d]=(0,a.useState)([]),[u,p]=(0,a.useState)(null),[h,x]=(0,a.useState)(null),[g,w]=(0,a.useState)(!1),[f,y]=(0,a.useState)(null),[v,b]=(0,a.useState)([]);(0,a.useEffect)((()=>{e&&k()}),[e]);const k=async()=>{try{const e=await(0,i.M5)(),t=(0,i.CN)(e,"sheetname");if(!t)throw new Error("‚ö†Ô∏è 'sheetname' —Ç–æ—Ö–∏—Ä–≥–æ–æ –æ–ª–¥—Å–æ–Ω–≥“Ø–π");await Excel.run((async e=>{const n=e.workbook.worksheets.getItem(t).getUsedRange();n.load("values"),await e.sync();const a=n.values;if(a.length<2)throw new Error("‚ö†Ô∏è Sheet-–¥ —à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π –º—ç–¥—ç—ç–ª—ç–ª –∞–ª–≥–∞ –±–∞–π–Ω–∞");const o=a[0],s=a.slice(1),r=o[o.length-1];y(r);const i=s.map(((e,t)=>{const n={};return o.forEach(((t,a)=>{n[t]=S(e[a],t)})),n.__index=t+1,n.__lastKey=r,n.__lastValue=e[o.length-1],n}));d(i)}))}catch(e){console.error("‚ùå Sheet-—ç—ç—Å —É–Ω—à–∏—Ö–∞–¥ –∞–ª–¥–∞–∞:",e),o("‚ùå "+e.message)}},S=(e,t="")=>{const n=t.toLowerCase();if((n.includes("–æ–≥–Ω–æ–æ")||n.includes("date"))&&"number"==typeof e&&Number.isInteger(e)&&e>=1&&e<=6e4){const t=new Date(1899,11,30);return new Date(t.getTime()+864e5*(e+1)).toISOString().split("T")[0]}if("string"==typeof e&&!/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const a=parseFloat(e);return!isNaN(a)&&Number.isFinite(a)&&e.toString().length<=15?new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a):e},E=[...c.filter((e=>{const t=Object.values(e).some((e=>e?.toString().toLowerCase().includes(s.toLowerCase()))),n=!g||"‚úÖ –°–æ–Ω–≥–æ—Å–æ–Ω"!==e.__lastValue;return t&&n}))].sort(((e,t)=>{for(const{key:n,direction:a}of v){const o=e[n],s=t[n],r=o?.toString().trim(),i=s?.toString().trim(),l=e=>/^\d{4}-\d{2}-\d{2}$/.test(e),c=l(r),d=l(i);let u=0;if(c&&d)u=new Date(r)-new Date(i);else{const e=parseFloat(r.replace(/[, ]/g,"")),t=parseFloat(i.replace(/[, ]/g,"")),n=!isNaN(e)&&isFinite(e),a=!isNaN(t)&&isFinite(t);u=n&&a?e-t:r.localeCompare(i,void 0,{numeric:!0,sensitivity:"base"})}if(0!==u)return"ascending"===a?u:-u}return 0}));return e?(0,m.jsx)("div",{style:te.overlay,children:(0,m.jsxs)("div",{style:te.modal,children:[(0,m.jsx)("h2",{style:te.title,children:"üìãSheet-—ç—ç—Å —Ö–∞–π—Ö"}),(0,m.jsx)(D.p,{appearance:"outline",contentBefore:(0,m.jsx)(ee.u5x,{}),placeholder:"–•–∞–π–ª—Ç —Ö–∏–π—Ö...",value:s,onChange:(e,t)=>l(t.value),style:{marginBottom:"10px"}}),(0,m.jsx)(X.S,{label:"–°–æ–Ω–≥–æ—Å–æ–Ω –º”©—Ä–∏–π–≥ Excel-—ç—ç—Å —Ç“Ø—Ä –Ω—É—É—Ö",checked:g,onChange:(e,t)=>w(t.checked),style:{marginBottom:"10px"}}),(0,m.jsx)("button",{onClick:()=>{b([])},children:"–°–æ—Ä—Ç –∞—Ä–∏–ª–≥–∞—Ö"}),u&&(0,m.jsxs)("div",{style:te.selectedRow,children:[(0,m.jsxs)("span",{children:["‚úÖ –°–æ–Ω–≥–æ–≥–¥—Å–æ–Ω: ",JSON.stringify(u)]}),(0,m.jsx)("button",{style:te.undoButton,onClick:async()=>{h&&(await(0,r.i1)(h,o,n),x(null),p(null))},children:"–ë—É—Ü–∞–∞—Ö"})]}),(0,m.jsx)("div",{style:te.tableContainer,children:(0,m.jsxs)("table",{style:te.table,children:[(0,m.jsx)("thead",{children:(0,m.jsx)("tr",{children:Object.keys(c[0]||{}).filter((e=>!e.startsWith("__"))).map((e=>{const t=v.findIndex((t=>t.key===e)),n=v[t],a=n?"ascending"===n.direction?(0,m.jsx)(L.qcP,{}):(0,m.jsx)(L.DMF,{}):null;return(0,m.jsx)("th",{style:{...te.th,cursor:"pointer"},onClick:()=>(e=>{b((t=>{const n=t.find((t=>t.key===e));if(n){const a="ascending"===n.direction?"descending":"ascending";return t.map((t=>t.key===e?{...t,direction:a}:t))}return[...t,{key:e,direction:"ascending"}]}))})(e),children:(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,m.jsx)("span",{children:e}),a,t>=0&&(0,m.jsxs)("span",{style:{fontSize:"10px",opacity:.5},children:["(",t+1,")"]})]})},e)}))})}),(0,m.jsx)("tbody",{children:E.map(((e,t)=>(0,m.jsx)("tr",{style:te.tr,onDoubleClick:()=>(async e=>{try{const t=await(0,r.bp)(o,n);x(t),p(e);const a=e[0]||Object.values(e)[0];await(0,r.i1)(a,o,n);const s=e.__index,l=e.__lastKey||f||"–°–æ–Ω–≥–æ—Å–æ–Ω —ç—Å—ç—Ö";d((e=>e.map((e=>e.__index===s?{...e,[l]:"‚úÖ –°–æ–Ω–≥–æ—Å–æ–Ω",__lastValue:"‚úÖ –°–æ–Ω–≥–æ—Å–æ–Ω"}:e)))),await Excel.run((async e=>{const t=await(0,i.M5)(),n=(0,i.CN)(t,"sheetname"),a=e.workbook.worksheets.getItem(n),o=a.getUsedRange();o.load("values,columnCount"),await e.sync();let r=o.columnCount;const l=o.values[0];l.includes("–°–æ–Ω–≥–æ—Å–æ–Ω —ç—Å—ç—Ö")?r=l.indexOf("–°–æ–Ω–≥–æ—Å–æ–Ω —ç—Å—ç—Ö"):(a.getCell(0,r).values=[["–°–æ–Ω–≥–æ—Å–æ–Ω —ç—Å—ç—Ö"]],await e.sync()),a.getCell(s,r).values=[["‚úÖ –°–æ–Ω–≥–æ—Å–æ–Ω"]],await e.sync()}))}catch(e){o("‚ùå –ê–ª–¥–∞–∞: "+e.message)}})(e),children:Object.entries(e).filter((([e])=>!e.startsWith("__"))).map((([e,t],n)=>(0,m.jsx)("td",{style:te.td,children:t},n)))},t)))})]})}),(0,m.jsx)("div",{style:{marginTop:"15px",textAlign:"right"},children:(0,m.jsx)("button",{style:te.closeButton,onClick:t,children:"–•–∞–∞—Ö"})})]})}):null};const ae=[{title:"–•”©—Ä–≤“Ø“Ø–ª—ç—Ö —Ö—ç—Ä—ç–≥—Å—ç–ª",tools:[{icon:(0,m.jsx)(_.D3L,{}),label:"–¢–æ–æ —Ä—É—É —Ö”©—Ä–≤“Ø“Ø–ª—ç—Ö"},{icon:(0,m.jsx)(_.D3L,{}),label:"–¢–µ–∫—Å—Ç —Ä“Ø“Ø —Ö”©—Ä–≤“Ø“Ø–ª—ç—Ö"},{icon:(0,m.jsx)(L.Jj7,{}),label:"–•–∞–∞–Ω—ã —Ö—É—É–ª–≥–∞ —è–Ω–∑–ª–∞—Ö"},{icon:(0,m.jsx)(K,{}),label:"–°–æ–Ω–≥–æ—Å–æ–Ω –º—É–∂–∏–π–≥ —ç–∫–ø–æ—Ä—Ç —Ö–∏–π—Ö"}]},{title:"–¢—É—Å–ª–∞—Ö —Ö—ç—Ä—ç–≥—Å—ç–ª",tools:[{icon:(0,m.jsx)($.G4r,{}),label:"–ò–¥—ç–≤—Ö–∏—Ç—ç–π –Ω“Ø–¥—ç—ç—Ä —à“Ø“Ø–ª—Ç —Ö–∏–π—Ö"},{icon:(0,m.jsx)(z.Z6Q,{}),label:"–®“Ø“Ø–ª—Ç –∞—Ä–∏–ª–≥–∞—Ö"},{icon:(0,m.jsx)(O.xsY,{}),label:"”®–Ω–≥”©”©—Ä —è–ª–≥–∞—Ö"},{icon:(0,m.jsx)(O.vxz,{}),label:"Paste value"},{icon:(0,m.jsx)(G.glr,{}),label:"–ò–¥—ç–≤—Ö–∏—Ç—ç–π –Ω“Ø–¥—ç–Ω–¥ –æ–≥–Ω–æ–æ –æ—Ä—É—É–ª–∞—Ö"},{icon:(0,m.jsx)(G.glr,{}),label:"Date convert"},{icon:(0,m.jsx)(M.aZ_,{}),label:"Goal seek"},{icon:(0,m.jsx)(M.aZ_,{}),label:"Multi Goal seek"},{icon:(0,m.jsx)(H.vr6,{}),label:"–î–∏–Ω–∞–º–∏–∫ —Ö“Ø—Å–Ω—ç–≥—Ç"}]},{title:"API —Ö–æ–ª–±–æ–ª—Ç—É—É–¥",tools:[{icon:(0,m.jsx)(P.nrj,{}),label:"–ê–ª–±–∞–Ω —Ö–∞–Ω—à —Ç–∞—Ç–∞—Ö"},{icon:(0,m.jsx)(V.tLA,{}),label:"–ú–∞—à–∏–Ω—ã –º—ç–¥—ç—ç–ª—ç–ª —Ç–∞—Ç–∞—Ö"},{icon:(0,m.jsx)(_.VhZ,{}),label:"–•–∞–∞–Ω—ã token —Ç–∞—Ç–∞—Ö"},{icon:(0,m.jsx)(Q,{}),label:"–•–∞–∞–Ω—ã —Ö—É—É–ª–≥–∞ —Ç–∞—Ç–∞—Ö"},{icon:(0,m.jsx)(W.PnP,{}),label:"–•–∞–∞–Ω—ã –¥–∞–Ω—Å –ª–∞–≤–ª–∞—Ö"}]},{title:"Ebarimt —Ö—ç—Ä—ç–≥—Å–ª“Ø“Ø–¥",tools:[{icon:(0,m.jsx)(F.aCb,{}),label:"–†–î-–∞–∞—Ä “Æ–ê –ª–∞–≤–ª–∞—Ö"}]},{title:"–î–∞–Ω—Å–Ω—ã —É–¥–∏—Ä–¥–ª–∞–≥–∞",tools:[{icon:(0,m.jsx)(J.rz9,{}),label:"–ï–î–î –¥–∞–Ω—Å “Ø“Ø—Å–≥—ç—Ö"},{icon:(0,m.jsx)(J.TjP,{}),label:"–î–∞–Ω—Å “Ø“Ø—Å–≥—ç—Ö"},{icon:(0,m.jsx)(J.QxP,{}),label:"–•–∞—Ä–∏–ª—Ü–∞–≥—á “Ø“Ø—Å–≥—ç—Ö"}]},{title:"–ü–æ–ª–∞—Ä–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∂—É—É–ª–∞–ª—Ç",tools:[{icon:(0,m.jsx)($.G4r,{}),label:"PS –ó—ç—ç–ª–∏–π–Ω –±–∞–ª–∞–Ω—Å"},{icon:(0,m.jsx)($.G4r,{}),label:"PS –ó—ç—ç–ª–∏–π–Ω –æ–ª–≥–æ–ª—Ç"},{icon:(0,m.jsx)($.G4r,{}),label:"PS –ó—ç—ç–ª–∏–π–Ω —Ç”©–ª”©–ª—Ç"},{icon:(0,m.jsx)($.G4r,{}),label:"PS –ó—ç—ç–ª–∏–π–Ω –∑–æ—Ä–∏—É–ª–∞–ª—Ç, —Ö—É–≥–∞—Ü–∞–∞"},{icon:(0,m.jsx)($.G4r,{}),label:"”®–≥”©–≥–¥”©–ª –æ—Ä—É—É–ª–∞—Ö"}]}];var oe=({isSidebarOpen:e})=>{const{setLoading:t,showMessage:n}=(0,j.U)(),[y,v]=(0,a.useState)(!1),[k,S]=(0,a.useState)(!1),[C,A]=(0,a.useState)(!1),[I,D]=(0,a.useState)(!1),[T,B]=(0,a.useState)(!1),[U,_]=(0,a.useState)(!1),[L,$]=(0,a.useState)(!1),z=(0,a.useRef)(null);(0,a.useEffect)((()=>{const e=()=>{$(window.innerWidth<500)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const O={"–¢–æ–æ —Ä—É—É —Ö”©—Ä–≤“Ø“Ø–ª—ç—Ö":()=>r.Ak(n,t),"–¢–µ–∫—Å—Ç —Ä“Ø“Ø —Ö”©—Ä–≤“Ø“Ø–ª—ç—Ö":()=>r.cR(n,t),"–î–∏–Ω–∞–º–∏–∫ —Ö“Ø—Å–Ω—ç–≥—Ç":()=>B(!0),"–ê–ª–±–∞–Ω —Ö–∞–Ω—à —Ç–∞—Ç–∞—Ö":()=>async function(e,t){return(0,i.$A)(t,e,(async()=>{e("‚è≥ –•–∞–Ω—à–∏–π–Ω –º—ç–¥—ç—ç–ª—ç–ª —Ç–∞—Ç–∞–∂ –±–∞–π–Ω–∞...");const{startDate:t,endDate:n}=await Excel.run((async e=>{const t=e.workbook.getActiveCell();t.load("values"),await e.sync();let n=t.values[0][0];if(!n||"number"!=typeof n&&"string"!=typeof n)throw new Error("üìÖ –ò–¥—ç–≤—Ö—Ç—ç–π –Ω“Ø–¥—ç–Ω–¥ –æ–≥–Ω–æ–æ –æ—Ä—É—É–ª–Ω–∞ —É—É (2025-01-30 —ç—Å–≤—ç–ª Excel –æ–≥–Ω–æ–æ–Ω—ã format)");if("number"==typeof n){const e=new Date(1899,11,30);n=new Date(e.getTime()+864e5*n).toISOString().split("T")[0]}if("string"==typeof n&&!/^\d{4}-\d{2}-\d{2}$/.test(n))throw new Error("üìÖ –û–≥–Ω–æ–æ–Ω—ã —Ñ–æ—Ä–º–∞—Ç –±—É—Ä—É—É –±–∞–π–Ω–∞. YYYY-MM-DD —Ö—ç–ª–±—ç—Ä—Ç—ç–π –±–∞–π–≤–∞–ª –∑–æ—Ö–∏–º–∂—Ç–æ–π.");return{startDate:n,endDate:n}}));e(`üìÖ –û–≥–Ω–æ–æ: ${t} - ${n}`);const a=await fetch(`https://www.mongolbank.mn/mn/currency-rates/data?startDate=${t}&endDate=${n}`,{method:"POST",headers:{"Content-Type":"application/json"}}),o=await a.json();if(a.ok||(0,i.tv)(a,o),!o||!Array.isArray(o.data))throw new Error("–ë—É—Ü–∞–∂ –∏—Ä—Å—ç–Ω –¥–∞—Ç–∞ –¥–æ—Ç–æ—Ä Array –±–∞–π—Ö–≥“Ø–π –±–∞–π–Ω–∞.");return await Excel.run((async t=>{const n=t.workbook.worksheets.getActiveWorksheet();if(n.load("name"),await t.sync(),"rate"!==n.name.toLowerCase())throw new Error("‚ö†Ô∏è –≠–Ω—ç —Ñ—É–Ω–∫—Ü –∑”©–≤—Ö”©–Ω 'rate' –Ω—ç—Ä—Ç—ç–π sheet –¥—ç—ç—Ä –∞–∂–∏–ª–ª–∞–Ω–∞.");const a=t.workbook.getActiveCell();a.load(["rowIndex","columnIndex"]),await t.sync();const s=a.rowIndex,r=a.columnIndex,i=o.data[0],l=i.USD,c=i.JPY,d=new Date(i.RATE_DATE).toISOString().split("T")[0];if(!l||!c||!d)throw new Error("USD —ç—Å–≤—ç–ª JPY —Ö–∞–Ω—à –æ–ª–¥—Å–æ–Ω–≥“Ø–π.");n.getCell(s,r+2).values="1",n.getCell(s,r+3).values=[[l]],n.getCell(s,r+4).values=[[c]],await t.sync(),e(`‚úÖ ${d} ”©–¥—Ä–∏–π–Ω USD –±–æ–ª–æ–Ω JPY —Ö–∞–Ω—à –∞–º–∂–∏–ª—Ç—Ç–∞–π –±–∏—á–∏–≥–¥–ª—ç—ç.`)})),{result:o,response:a}}))}(n,t),"–ú–∞—à–∏–Ω—ã –º—ç–¥—ç—ç–ª—ç–ª —Ç–∞—Ç–∞—Ö":()=>async function(e,t){return(0,i.$A)(t,e,(async()=>{e("‚è≥ –ú–∞—à–∏–Ω—ã –º—ç–¥—ç—ç–ª—ç–ª —Ç–∞—Ç–∞–∂ –±–∞–π–Ω–∞...");let t=await(0,i.M5)(),n=(0,i.CN)(t,"car_token");const a=await Excel.run((async e=>{const t=e.workbook.getActiveCell();t.load("values"),await e.sync();const n=t.values[0][0];if(!n||"string"!=typeof n)throw new Error("üìÑ –ò–¥—ç–≤—Ö—Ç—ç–π –Ω“Ø–¥—ç–Ω–¥ –º–∞—à–∏–Ω—ã –¥—É–≥–∞–∞—Ä –±–∏—á–Ω—ç “Ø“Ø.");return n.trim().replace(/-/g,"")}));async function o(e){const t=await fetch("https://service.transdep.mn/autobox-backend/api/v1/vehicle/data",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({plate_no:a})}),n=await t.json();return{response:t,result:n}}let{response:s,result:r}=await o(n);401===s.status&&(n=await async function(){const e=await fetch("https://service.transdep.mn/autobox-backend/api/v1/user/login",{method:"POST",headers:{"Content-Type":"application/json"}}),t=await e.json();if(!e.ok||!t.token)throw new Error("‚ùå Token –∞–≤–∞—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞: "+(t.status?.message||"–ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞."));return t.token}(),await(0,i.kB)("car_token",n),({response:s,result:r}=await o(n))),s.ok||(0,i.tv)(s,r);const l=r.data;if(!l)throw new Error("‚ö†Ô∏è –ú–∞—à–∏–Ω—ã 'data' –º—ç–¥—ç—ç–ª—ç–ª —Ö–æ–æ—Å–æ–Ω –±–∞–π–Ω–∞.");const c=["cabin_no","declaration_no","mark_name","build_year","build_month","imported_date","color_name","country_name","model_name","purpose_name","fuel_type_eco_class_name","fuel_type_name","steering_type_name","vehicle_type_name","wheel_name","owner.first_name","owner.register"].map((e=>{if(e.includes(".")){const t=e.split(".").reduce(((e,t)=>e?.[t]),l);return`${e}: ${t??""}`}return`${e}: ${l[e]??""}`})).join("<br>");return e(`‚ö†Ô∏è –ú–∞—à–∏–Ω—ã –º—ç–¥—ç—ç–ª—ç–ª:<br>${c}`),{response:s,result:r,data:l}}))}(n,t),"–•–∞–∞–Ω—ã token —Ç–∞—Ç–∞—Ö":()=>c(n,t),"–•–∞–∞–Ω—ã —Ö—É—É–ª–≥–∞ —Ç–∞—Ç–∞—Ö":()=>async function(e,t){return(0,i.$A)(t,e,(async()=>{e("‚è≥ –•—É—É–ª–≥–∞ —Ç–∞—Ç–∞–∂ –±–∞–π–Ω–∞...");const t=await(0,i.M5)(),n=(0,i.CN)(t,"access_token"),{accountNo:a,fromDate:o,toDate:s}=await Excel.run((async e=>{const t=e.workbook.worksheets.getItem("Import").getRange("B3:B5");t.load("values"),await e.sync();const[a,o,s]=t.values.map((e=>e[0]));if(!(n&&a&&o&&s))throw new Error("üìå B2-B5 –Ω“Ø–¥–Ω“Ø“Ø–¥—ç–¥ token, accountNo, fromDate, toDate –±“Ø–≥–¥ –±–∞–π—Ö —à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π!");return{accountNo:a.toString().trim(),fromDate:(0,i.t5)(o+1,"fromDate"),toDate:(0,i.t5)(s+1,"toDate")}})),r=new Headers;r.append("Authorization",`Bearer ${n}`),r.append("Referer","https://corp.khanbank.com"),r.append("Origin","https://corp.khanbank.com"),r.append("Host","api.khanbank.com:9003");const l=`https://api.khanbank.com:9003/v3/omni/accounts/receipt/${a}?transactionDate=%7B%22lt%22:%22${o}T17:42:30%22,%22gt%22:%22${s}T09:57:20%22%7D&docType=0&transactionAmount=%7B%22gt%22:%220%22,%22lt%22:%220%22%7D`,c=await fetch(l,{method:"GET",headers:r,redirect:"follow"}),d=await c.json();c.ok||(0,i.tv)(c,d);const u=d.transactions.map((e=>({transactionDate:`${e.transactionDate} ${e.txnTime||""}`,txnBranchId:e.txnBranchId,beginBalance:e.beginBalance.amount,Debit:"Debit"===e.amountType.codeDescription?e.amount.amount:"",Credit:"Credit"===e.amountType.codeDescription?e.amount.amount:"",endBalance:e.endBalance.amount,transactionRemarks:e.transactionRemarks,accountId:(0,i.sz)(e.accountId)})));return await Excel.run((async e=>{const t=e.workbook.worksheets.getItem("Import"),n=["transactionDate","txnBranchId","beginBalance","Debit","Credit","endBalance","transactionRemarks","accountId"],a=u.map((e=>[e.transactionDate,e.txnBranchId,e.beginBalance,e.Debit,e.Credit,e.endBalance,e.transactionRemarks,e.accountId]));t.getRange("A8:H8").values=[n],t.getRangeByIndexes(8,0,a.length,n.length).values=a,await e.sync()})),e("‚úÖ –•—É—É–ª–≥–∞ –∞–º–∂–∏–ª—Ç—Ç–∞–π —Ç–∞—Ç–∞–≥–¥–∞–∂, Excel-–¥ –±–∏—á–∏–≥–¥–ª—ç—ç."),{result:d,response:c}}))}(n,t),"–•–∞–∞–Ω—ã –¥–∞–Ω—Å –ª–∞–≤–ª–∞—Ö":()=>async function(e,t){return(0,i.$A)(t,e,(async()=>{e("‚è≥ –î–∞–Ω—Å –ª–∞–≤–ª–∞–∂ –±–∞–π–Ω–∞...");const n=await(0,i.M5)();let a=(0,i.CN)(n,"access_token");const{accountNo:o,activeCellAddress:s}=await Excel.run((async e=>{const t=e.workbook.getActiveCell();t.load("values, address"),await e.sync();const n=t.values[0][0];if(!a||!n)throw new Error("üìå –ò–¥—ç–≤—Ö—Ç—ç–π –Ω“Ø–¥—ç–Ω–¥ accountNo –±–∞–π—Ö —à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π!");return{accountNo:n.toString().trim(),activeCellAddress:t.address}})),r=/^MN[a-zA-Z0-9]{16,}$/.test(o),l=r?`https://api.khanbank.com:9003/v3/omni/accounts/inquiry/${o}`:`https://api.khanbank.com:9003/v3/omni/corp/custom/counterparties/accDetails/${o}`,d=async e=>{const t=new Headers;t.append("Authorization",`Bearer ${e}`),t.append("Referer","https://corp.khanbank.com"),t.append("Origin","https://corp.khanbank.com"),t.append("Host","api.khanbank.com:9003");const n=await fetch(l,{method:"GET",headers:t,redirect:"follow"}),a=await n.json();return{response:n,result:a}};let{response:u,result:p}=await d(a);if(401===u.status){const n=await c(e,t);a=n.result.access_token,({response:u,result:p}=await d(a))}u.ok||(0,i.tv)(u,p);const h=r?p?.name||"":p?.counterpartyName||"";return await Excel.run((async e=>{e.workbook.getActiveCell().getOffsetRange(0,1).values=[[h]],await e.sync()})),console.log("‚úÖ –î–∞–Ω—Å–Ω—ã –º—ç–¥—ç—ç–ª—ç–ª:",p),e("‚úÖ –î–∞–Ω—Å –ª–∞–≤–ª–∞–≥–¥–∞–∂, –±–∞—Ä—É—É–Ω –Ω“Ø–¥—ç–Ω–¥ –±–∏—á–∏–≥–¥–ª—ç—ç."),{result:p,response:u,accountDetail:h,activeCellAddress:s}}))}(n,t),"–†–î-–∞–∞—Ä “Æ–ê –ª–∞–≤–ª–∞—Ö":()=>async function(e,t){return await(0,i.$A)(t,e,(async()=>{const t=await Excel.run((async e=>{const t=e.workbook.getActiveCell();t.load("values"),await e.sync();const n=t.values[0][0];if(!n||isNaN(n))throw new Error("üìå ID —Ç–æ–æ —Ö—ç–ª–±—ç—Ä—Ç—ç–π –±–∞–π—Ö —ë—Å—Ç–æ–π.");return n})),n=`${l.C}/api/merchant/${t}`;let a;try{a=await fetch(n)}catch(e){throw new Error("‚ùå –°–∞–π—Ç —Ä—É—É fetch —Ö–∏–π—Ö—ç–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞: "+e.message)}if(!a.ok)throw new Error(`‚ùå HTTP –∞–ª–¥–∞–∞: ${a.status}`);const o=await a.text();if("undefined"==typeof DOMParser)throw new Error("‚ùå DOMParser –¥—ç–º–∂–∏–≥–¥—ç—Ö–≥“Ø–π –æ—Ä—á–∏–Ω–¥ –∞–∂–∏–ª–ª—É—É–ª–∂ –±–∞–π–Ω–∞.");const s=(new DOMParser).parseFromString(o,"text/html"),r=s.querySelector("table"),i=s.querySelector("title")?.textContent||"–ì–∞—Ä—á–∏–≥ –æ–ª–¥—Å–æ–Ω–≥“Ø–π";if(!r)throw new Error("‚ö†Ô∏è –•“Ø—Å–Ω—ç–≥—Ç –æ–ª–¥—Å–æ–Ω–≥“Ø–π.");let c=`${i}\n`;const d=r.querySelectorAll("tr");for(let e=1;e<d.length;e++){const t=d[e].querySelectorAll("td");c+=Array.from(t).map((e=>e.textContent.trim())).join(" ")+"\n"}return e("üìã “Æ—Ä –¥“Ø–Ω:\n"+c),{result:c,response:a}}))}(n,t),"–ò–¥—ç–≤—Ö–∏—Ç—ç–π –Ω“Ø–¥—ç—ç—Ä —à“Ø“Ø–ª—Ç —Ö–∏–π—Ö":()=>r.BG(n,t),"–®“Ø“Ø–ª—Ç –∞—Ä–∏–ª–≥–∞—Ö":()=>r.bk(n,t),"–°–æ–Ω–≥–æ—Å–æ–Ω –º—É–∂–∏–π–≥ —ç–∫–ø–æ—Ä—Ç —Ö–∏–π—Ö":()=>r._Z(n,t),"–ò–¥—ç–≤—Ö–∏—Ç—ç–π –Ω“Ø–¥—ç–Ω–¥ –æ–≥–Ω–æ–æ –æ—Ä—É—É–ª–∞—Ö":()=>D(!0),"PS –ó—ç—ç–ª–∏–π–Ω –±–∞–ª–∞–Ω—Å":()=>async function(e,t){return(0,i.$A)(t,e,(async()=>{await Excel.run((async t=>{e("‚è≥ –ê–∂–∏–ª–ª–∞–∂ –±–∞–π–Ω–∞...");const n=t.workbook.worksheets.getActiveWorksheet(),a=n.getCell(0,2);a.load("values"),await t.sync();const o=a.values[0][0];if(!o||!o.toString().includes("–ó–≠–≠–õ–ò–ô–ù “Æ–õ–î–≠–ì–î–õ–ò–ô–ù –î–≠–õ–ì–≠–†–≠–ù–ì“Æ–ô –¢–ê–ô–õ–ê–ù"))throw new Error("‚ö†Ô∏è ‚ö†Ô∏è –≠–Ω—ç —Ö—É—É–¥–∞—Å –ó–≠–≠–õ–ò–ô–ù “Æ–õ–î–≠–ì–î–õ–ò–ô–ù –î–≠–õ–ì–≠–†–≠–ù–ì“Æ–ô –¢–ê–ô–õ–ê–ù –±–∏—à –±–∞–π–Ω–∞..");const s=await f(n,0);!function(e,t,n,a=0){["HUGATSAANII INTERVAL","SEGMENT1","ANGILAL1","BUTEEGDEHUUN1"].forEach(((n,o)=>{e.getCell(t,a+o).values=[[n]]}))}(n,4,0,54),await t.sync();const r=await g(n),i=n.getCell(2,1);i.load("values"),await t.sync();const l=new Date(Date.parse(i.values[0][0].toString().substring(9))),c=n.getRangeByIndexes(5,0,s-5,55);c.load("values"),await t.sync();const p=c.values,h=[],x=[],m=[],y=[];for(let e=0;e<p.length;e++){const t=p[e],n=t[r["–°–ï–ì–ú–ï–ù–¢"]]?.toString().substring(0,2),a=t[r["–ó–û–†–ò–£–õ–ê–õ–¢"]]?.toString().substring(0,2),o=t[r["–ê–ù–ì–ò–õ–ê–õ"]]?.toString().substring(4).replace(/–ú–£–£|–•–≠–í–ò–ô–ù –ë–£–°|–≠–†–ì–≠–õ–ó–≠–≠–¢–≠–ô/g,"–ß–ê–ù–ê–†–ì“Æ–ô");let s="";s="06"===a?"“Æ–ª —Ö”©–¥–ª”©—Ö —Ö”©—Ä”©–Ω–≥”©":"81"===n&&"21"===a?"–•—ç—Ä—ç–≥–ª—ç—ç–Ω–∏–π –∑—ç—ç–ª":"81"===n&&"18"===a?"–ë—É—Å–∞–¥":t[r["–ë“Æ–¢–≠–≠–ì–î–≠–•“Æ“Æ–ù–ò–ô –ù–≠–†"]];let i=t[r["–î–£–£–°–ê–• –û–ì–ù–û–û"]];const c=d(((isNaN(i)?new Date(Date.parse(i)):w(i))-l)/864e5);h.push([n]),x.push([o]),m.push([s]),y.push([c])}n.getRangeByIndexes(5,r.SEGMENT1,p.length,1).values=h,n.getRangeByIndexes(5,r.ANGILAL1,p.length,1).values=x,n.getRangeByIndexes(5,r.BUTEEGDEHUUN1,p.length,1).values=m,n.getRangeByIndexes(5,r["HUGATSAANII INTERVAL"],p.length,1).values=y,await t.sync(),await async function(e,t){await u(e,t,"–ó–û–†–ò–£–õ–ê–õ–¢")}(n,r),await async function(e,t){await u(e,t,"BUTEEGDEHUUN1")}(n,r),await async function(e,t){await u(e,t,"–°–ï–ì–ú–ï–ù–¢")}(n,r),await async function(e,t){await u(e,t,"HUGATSAANII INTERVAL")}(n,r),await async function(e,t){await u(e,t,"–ú–ê–®–ò–ù")}(n,r),await async function(e,t){await u(e,t,"–ê–ù–ì–ò–õ–ê–õ")}(n,r),e("‚úÖ Loan report pre-calculation complete.")}))}))}(n,t),"PS –ó—ç—ç–ª–∏–π–Ω –æ–ª–≥–æ–ª—Ç":()=>async function(e,t){return(0,i.$A)(t,e,(async()=>{await Excel.run((async t=>{e("‚è≥ –ê–∂–∏–ª–ª–∞–∂ –±–∞–π–Ω–∞...");const n=t.workbook.worksheets.getActiveWorksheet();await x(n);const a=n.getCell(1,0);a.load("values"),await t.sync();const o=a.values[0][0];if(!o||!o.toString().includes("–û–ª–≥–æ—Å–æ–Ω –∑—ç—ç–ª–∏–π–Ω —Ç–∞–π–ª–∞–Ω"))throw new Error("‚ö†Ô∏è –≠–Ω—ç —Ö—É—É–¥–∞—Å –æ–ª–≥–æ—Å–æ–Ω –∑—ç—ç–ª–∏–π–Ω —Ç–∞–π–ª–∞–Ω –±–∏—à –±–∞–π–Ω–∞.");const s=["–ù–≠–†","–†–ï–ì–ò–°–¢–ï–†","–ó–≠–≠–õ –û–õ–ì–û–°–û–ù –û–ì–ù–û–û","–ó–≠–≠–õ –¢”®–õ”®–ì–î”®–• –û–ì–ù–û–û","–ó–û–†–ò–£–õ–ê–õ–¢","–¢”®–õ”®–í","–î–ê–ù–°","–•“Æ“Æ","–•–£–ì–ê–¶–ê–ê","–í–ê–õ–Æ–¢","0","–î“Æ–ù","BUTEEGDEHUUNII_NER","–û–õ–ì–û–°–û–ù –î“Æ–ù","0","0","–û–õ–ì–û–°–û–ù –ê–ñ–ò–õ–¢–ê–ù","0","–•–ê–†–ò–£–¶–°–ê–ù –ê–ñ–ò–õ–¢–ê–ù","BUTEEGDEHUUN1","JDH_DUN","HUGATSAANII INTERVAL","SEGMENT1"];for(let e=2;e<s.length+2;e++)n.getCell(4,e).values=[[s[e-2]]];await t.sync();const r=await g(n),i=n.getUsedRange();i.load("values"),await t.sync();const l=i.values,c=r["–û–õ–ì–û–°–û–ù –î“Æ–ù"],d=(r["–ó–≠–≠–õ –û–õ–ì–û–°–û–ù –û–ì–ù–û–û"],r.BUTEEGDEHUUN1),u=r.BUTEEGDEHUUNII_NER,h=r["–ó–û–†–ò–£–õ–ê–õ–¢"],w=r["–•“Æ“Æ"],f=r["–†–ï–ì–ò–°–¢–ï–†"],m=r["–•–£–ì–ê–¶–ê–ê"];for(let e=5;e<l.length;e++){const t=l[e],n=t[u-1],a=l[e-1]?.[u],o=l[e-1]?.[3];t[u]=""===n||void 0===n?"":""===a||void 0===a?o:a;const s=parseFloat(t[c])||0,i=parseFloat(t[w])||0;t[r.JDH_DUN]=s*i/100;const p=parseFloat(t[m]);isNaN(p)||(t[r["HUGATSAANII INTERVAL"]]=p<=1?"1 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":p<=3?"1-3 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":p<=6?"3-6 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":p<=12?"6-12 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":p<=30?"12-30 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":p<=60?"30-60 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":"60-—Å –¥—ç—ç—à —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π"),t[f]&&10===t[f].toString().length&&(t[r.SEGMENT1]="81");const x=(t[h]||"").toString(),g=(t[r.SEGMENT1]||"").toString();let y=(t[u]||"").toString();y=y.includes("-")?y.split("-")[1].trim():y.trim(),x.startsWith("06")?t[d]="“Æ–õ –•”®–î–õ”®–• –•”®–†”®–ù–ì”®":"81"===g&&x.startsWith("21")?t[d]="–•–≠–†–≠–ì–õ–≠–≠–ù–ò–ô –ó–≠–≠–õ":"81"===g&&x.startsWith("18")?t[d]="–ë–£–°–ê–î":t[d]=y}for(let e=5;e<l.length;e++){const t=l[e];["BUTEEGDEHUUNII_NER","BUTEEGDEHUUN1","–ó–û–†–ò–£–õ–ê–õ–¢","JDH_DUN","HUGATSAANII INTERVAL","SEGMENT1"].forEach((a=>{t[r[a]]&&(n.getCell(e,r[a]).values=[[t[r[a]]]])}))}await async function(e,t){await p(e,t,"–ó–û–†–ò–£–õ–ê–õ–¢",!0)}(n,r),await async function(e,t){await p(e,t,"BUTEEGDEHUUN1",!0)}(n,r),await async function(e,t){await p(e,t,"HUGATSAANII INTERVAL",!1)}(n,r),await async function(e,t){await p(e,t,"–ú–ê–®–ò–ù",!1)}(n,r)})),await(0,i.rj)(e),e("‚úÖ BL1-–∏–π–≥ —à–∞–ª–≥–∞—Ö –ó—ç—ç–ª –æ–ª–≥–æ–ª—Ç complete.")}))}(n,t),"PS –ó—ç—ç–ª–∏–π–Ω —Ç”©–ª”©–ª—Ç":()=>async function(e,t){return(0,i.$A)(t,e,(async()=>{await Excel.run((async t=>{e("‚è≥ –ê–∂–∏–ª–ª–∞–∂ –±–∞–π–Ω–∞...");const n=t.workbook.worksheets.getActiveWorksheet(),a=n.getCell(0,0);a.load("values"),await t.sync();const o=a.values[0][0];if(!o||!o.toString().includes("–ì—ç–≥—ç—ç–Ω –∏–Ω–≤–µ—Å—Ç"))throw new Error("‚ö†Ô∏è –≠–Ω—ç —Ö—É—É–¥–∞—Å —Ç”©–ª”©–≥–¥—Å”©–Ω –∑—ç—ç–ª–∏–π–Ω —Ç–∞–π–ª–∞–Ω –±–∏—à –±–∞–π–Ω–∞.");await x(n);const s=["–î–ê–ù–°","–ó–≠–≠–õ–î–≠–ì–ß","–¢”®–õ”®–ì–î–°”®–ù –û–ì–ù–û–û","–í–ê–õ–Æ–¢","“Æ–ù–î–°–≠–ù –•“Æ“Æ","–¢–û–ì–£–£–õ–ò–ô–ù –•“Æ“Æ","–£–†–¨–î–ß–ò–õ–ñ –¢”®–õ–°”®–ù","–ó–≠–≠–õ","–ù–ò–ô–¢","–•–ê–ù–®","–ù–ò–ô–¢ –î“Æ–ù","–ó–ê–õ–†–£–£–õ–ì–ê –ó–≠–≠–õ","–ú–ê–®–ò–ù","–•“Æ“Æ–ù–ò–ô –î“Æ–ù","1","–ê–ù–ì–ò–õ–ê–õ","–°–ï–ì–ú–ï–ù–¢","–•–ê–†–ò–£–¶–ê–ì–ß","–î–ê–ù–°–ù–´ –¢”®–õ”®–í","–¢–ï–õ–õ–ï–†","BUTEEGDEHUUNII_NER","–ó–û–†–ò–£–õ–ê–õ–¢","–ó–≠–≠–õ–ò–ô–ù –•–£–ì–ê–¶–ê–ê","0","BUTEEGDEHUUN1","HUGATSAANII INTERVAL"];for(let e=0;e<s.length;e++)n.getCell(4,e).values=[[s[e]]];await t.sync();const r=await g(n),l=n.getUsedRange();l.load("values"),await t.sync();const c=l.values,d=r.BUTEEGDEHUUN1,u=r.BUTEEGDEHUUNII_NER,p=r["–ó–û–†–ò–£–õ–ê–õ–¢"],w=(r["–†–ï–ì–ò–°–¢–ï–†"],r["–ó–≠–≠–õ–ò–ô–ù –•–£–ì–ê–¶–ê–ê"]);for(let e=5;e<c.length;e++){const t=c[e],n=t[u-1],a=c[e-1]?.[u],o=c[e-1]?.[1];t[u]=""===n||void 0===n?"":""===a||void 0===a?o:a;const s=parseFloat(t[w]);isNaN(s)||(t[r["HUGATSAANII INTERVAL"]]=s<=1?"1 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":s<=3?"1-3 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":s<=6?"3-6 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":s<=12?"6-12 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":s<=30?"12-30 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":s<=60?"30-60 —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π":"60-—Å –¥—ç—ç—à —Å–∞—Ä —Ö“Ø—Ä—Ç—ç–ª —Ö—É–≥–∞—Ü–∞–∞—Ç–∞–π");const i=(t[p]||"").toString(),l=(t[r["–°–ï–ì–ú–ï–ù–¢"]]||"").toString();let h=(t[u]||"").toString();h=h.includes("-")?h.split("-")[1].trim():h.trim(),i.startsWith("06")?t[d]="“Æ–õ –•”®–î–õ”®–• –•”®–†”®–ù–ì”®":"81"===l&&i.startsWith("21")?t[d]="–•–≠–†–≠–ì–õ–≠–≠–ù–ò–ô –ó–≠–≠–õ":"81"===l&&i.startsWith("18")?t[d]="–ë–£–°–ê–î":t[d]=h}for(let e=5;e<c.length;e++){const t=c[e];["BUTEEGDEHUUNII_NER","BUTEEGDEHUUN1","–ó–û–†–ò–£–õ–ê–õ–¢","HUGATSAANII INTERVAL","–°–ï–ì–ú–ï–ù–¢"].forEach((a=>{t[r[a]]&&(n.getCell(e,r[a]).values=[[t[r[a]]]])}))}await async function(e,t){await h(e,t,"–ó–û–†–ò–£–õ–ê–õ–¢",!0)}(n,r),await async function(e,t){await h(e,t,"BUTEEGDEHUUN1",!0)}(n,r),await async function(e,t){await h(e,t,"HUGATSAANII INTERVAL",!1)}(n,r),await async function(e,t){await h(e,t,"–ú–ê–®–ò–ù",!0)}(n,r),await(0,i.rj)(e),e("‚úÖ BL1-–∏–π–≥ —à–∞–ª–≥–∞—Ö –ó—ç—ç–ª —Ç”©–ª”©–ª—Ç complete."),console.log("‚úÖ Import –Ω—ç—Ä—Ç—ç–π Sheet-–Ω–¥ –∑—ç—ç–ª–∏–π–Ω “Ø–ª–¥—ç–≥–¥—ç–ª –±–æ–ª–æ–Ω —Ö–∞–∞–≥–¥—Å–∞–Ω –∑—ç—ç–ª–∏–π–Ω —Ç–∞–π–ª–∞–Ω–≥ –æ—Ä—É—É–ª–∞–∞—Ä–∞–π.")}))}))}(n,t),"PS –ó—ç—ç–ª–∏–π–Ω –∑–æ—Ä–∏—É–ª–∞–ª—Ç, —Ö—É–≥–∞—Ü–∞–∞":()=>async function(e){try{await Excel.run((async t=>{const n=t.workbook.worksheets.getActiveWorksheet(),a=t.workbook.worksheets.getItemOrNullObject("Import");if(await t.sync(),a.isNullObject)return void e("‚ùå 'Import Sheet' –Ω—ç—Ä—Ç—ç–π worksheet –æ–ª–¥—Å–æ–Ω–≥“Ø–π.");await async function(e,t){const n=e.getCell(3,0);if(n.load("values"),await e.context.sync(),"–•–ê–ê–ì–î–°–ê–ù –ó–≠–≠–õ–ò–ô–ù –ú–≠–î–≠–≠"===n.values[0][0]){const n=e.getRange("A9:U9");n.load("values"),await e.context.sync();const a=n.values[0].map((e=>"string"==typeof e?e.toUpperCase():e));e.getRangeByIndexes(4,0,1,a.length).values=[a],e.getRange("A5").values=[["–î–ê–ù–°–ù–´ –î–£–ì–ê–ê–†"]],e.getRange("V5").values=[["–ó–≠–≠–õ–ò–ô–ù –•–£–ì–ê–¶–ê–ê"]],await e.context.sync(),t("‚ÑπÔ∏è '–•–ê–ê–ì–î–°–ê–ù –ó–≠–≠–õ–ò–ô–ù –ú–≠–î–≠–≠' —Ç—É–ª 9-—Ä –º”©—Ä–∏–π–Ω —É—Ç–≥—É—É–¥—ã–≥ —Ç–æ–º–æ–æ—Ä 5-—Ä –º”©—Ä”©–Ω–¥ —Ö—É—É–ª–∂, A5 –±–æ–ª–æ–Ω U5-–≥ —à–∏–Ω—ç—á–∏–ª–ª—ç—ç.")}}(a,e);const o=await g(a),s=await g(n),r=o["–î–ê–ù–°–ù–´ –î–£–ì–ê–ê–†"],i=o["–ó–û–†–ò–£–õ–ê–õ–¢"],l=o["–ó–≠–≠–õ–ò–ô–ù –•–£–ì–ê–¶–ê–ê"],c=s["–î–ê–ù–°"],d=s["–ó–û–†–ò–£–õ–ê–õ–¢"],u=s["–ó–≠–≠–õ–ò–ô–ù –•–£–ì–ê–¶–ê–ê"];if([r,i,l,c,d,u].includes(void 0))return void e("‚ö†Ô∏è –®–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π –±–∞–≥–∞–Ω—É—É–¥ –æ–ª–¥—Å–æ–Ω–≥“Ø–π (–î–ê–ù–°–ù–´ –î–£–ì–ê–ê–†, –ó–û–†–ò–£–õ–ê–õ–¢, –ó–≠–≠–õ–ò–ô–ù –•–£–ì–ê–¶–ê–ê).");const p=a.getUsedRange();p.load("rowCount, values");const h=n.getUsedRange();h.load("rowCount, values"),await t.sync();const x=p.values.slice(5),w=h.values.slice(5),f=new Map;x.forEach((e=>{const t=e[r];t&&f.set(t.toString().trim(),{purpose:e[i],term:e[l]})}));let m=0;w.forEach(((e,t)=>{const a=e[c];if(a&&f.has(a.toString().trim())){const{purpose:e,term:o}=f.get(a.toString().trim());n.getCell(t+5,d).values=[[e]],n.getCell(t+5,u).values=[[o]],m++}})),await t.sync(),e(`‚úÖ –ê–º–∂–∏–ª—Ç—Ç–∞–π —Ö–æ–ª–±–æ–æ–¥ –∑–æ—Ä–∏–ª–≥–æ –±–∞ —Ö—É–≥–∞—Ü–∞–∞–≥ ${m} –º”©—Ä –¥—ç—ç—Ä –æ—Ä—É—É–ª–ª–∞–∞.`)}))}catch(t){console.error("‚ùå –ê–ª–¥–∞–∞:",t),e("‚ùå –ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞: "+t.message)}}(n),"”®–≥”©–≥–¥”©–ª –æ—Ä—É—É–ª–∞—Ö":()=>z.current?.click(),"–ï–î–î –¥–∞–Ω—Å “Ø“Ø—Å–≥—ç—Ö":()=>v(!0),"–î–∞–Ω—Å “Ø“Ø—Å–≥—ç—Ö":()=>S(!0),"–•–∞—Ä–∏–ª—Ü–∞–≥—á “Ø“Ø—Å–≥—ç—Ö":()=>A(!0)};return(0,m.jsxs)("div",{style:{display:"flex",flexDirection:L?"column":"row",alignItems:"stretch",justifyContent:"flex-start",minHeight:"100vh",backgroundColor:"#f3f4f6",padding:"12px",width:e?"calc(100% - 250px)":"calc(85% - 50px)",marginLeft:e?"250px":"50px",transition:"margin-left 0.3s ease-in-out, width 0.3s ease-in-out"},children:[(0,m.jsx)("div",{style:{backgroundColor:"#fff",padding:"10px",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",width:L?"100%":"400px",textAlign:"center",borderRight:L?"none":"2px solid #ccc",minHeight:"calc(100vh - 20px)",marginBottom:"0",marginRight:L?"0":"20px",order:L?2:0},children:(0,m.jsx)(R,{})}),(0,m.jsx)("div",{style:{backgroundColor:"#e5e7eb",padding:"20px",borderRadius:"4px",minHeight:"calc(100vh - 20px)",width:"100%",maxWidth:L?"100%":"320px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column",alignItems:"center",order:L?1:0},children:ae.map(((e,a)=>(0,m.jsxs)("div",{style:{width:"100%",backgroundColor:"#fff",padding:"6px",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",marginBottom:"10px"},children:[(0,m.jsx)("h3",{style:{textAlign:"left",padding:"4px 0",fontSize:"12px",fontWeight:"bold",color:"#333",marginBottom:"4px",borderBottom:"1px solid #ccc"},children:e.title}),(0,m.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:"4px",padding:"4px",textAlign:"center"},children:e.tools.map(((e,a)=>(0,m.jsx)("div",{children:(0,m.jsx)(o.m,{content:e.label,relationship:"label",children:(0,m.jsx)(s.$,{icon:e.icon,appearance:"secondary",onClick:()=>(async e=>{await(0,i.$A)(t,n,(async()=>{await(O[e]?.())}))})(e.label),style:{width:"32px",height:"32px"}})})},a)))})]},a)))}),(0,m.jsx)("input",{ref:z,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:e=>(async({setLoading:e,showMessage:t,settingKey:n="PD_ALL",caseSensitive:a=!1})=>{try{await(0,i.$A)(e,t,(async()=>{const e=await(0,i.M5)(),o=parseInt((0,i.CN)(e,n),10);if(!Number.isInteger(o)||o<1)throw new Error(`‚ö†Ô∏è –¢–æ—Ö–∏—Ä–≥–æ–æ '${n}' –±—É—Ä—É—É –±–∞–π–Ω–∞ (—ç–µ—Ä—ç–≥ –±“Ø—Ö—ç–ª —Ç–æ–æ).`);const s=o-1;if(!Array.isArray(r.Lv)||0===r.Lv.length)throw new Error("‚ö†Ô∏è –ò–º–ø–æ—Ä—Ç—ã–Ω –¥–∞—Ç–∞ –æ–ª–¥—Å–æ–Ω–≥“Ø–π. –≠—Ö–ª—ç—ç–¥ —Ñ–∞–π–ª –∏–º–ø–æ—Ä—Ç–æ–æ—Ä–æ–æ —É–Ω—à—É—É–ª–Ω–∞ —É—É.");await Excel.run((async e=>{const t=e.workbook,n=t.getActiveCell();n.load(["rowIndex","columnIndex","values"]),await e.sync();const o=n.rowIndex,i=n.columnIndex,l=(n.values?.[0]?.[0]??"").toString().trim();if(!l)throw new Error("‚ö†Ô∏è –ò–¥—ç–≤—Ö—Ç—ç–π –Ω“Ø–¥ —Ö–æ–æ—Å–æ–Ω –±–∞–π–Ω–∞.");const c=a?l:l.toLowerCase();let d=-1;for(let e=0;e<r.Lv.length;e++){const t=(u=r.Lv[e]?.[i],(u??"").toString().trim());if((a?t:t.toLowerCase())===c){d=e;break}}var u;if(-1===d)throw new Error(`‚ö†Ô∏è –ò–º–ø–æ—Ä—Ç—ã–Ω –º–∞—Å—Å–∏–≤—ã–Ω ${i+1}-—Ä –±–∞–≥–∞–Ω–∞–¥ "${l}" –æ–ª–¥—Å–æ–Ω–≥“Ø–π.`);const p=r.Lv[d]?.[s]??"";t.worksheets.getActiveWorksheet().getCell(o,i+1).values=[[p]],await e.sync()})),t?.("‚úÖ –ò–º–ø–æ—Ä—Ç—ã–Ω –º–∞—Å—Å–∏–≤—Ç–∞–π –∞–º–∂–∏–ª—Ç—Ç–∞–π —Ç–∞–∞—Ä—É—É–ª–∂, –±–∞—Ä—É—É–Ω —Ç–∞–ª–¥ –±–∏—á–ª—ç—ç.")}))}catch(e){console.error(e),t?.(`‚ùå –ê–ª–¥–∞–∞: ${e?.message||e}`)}})({setLoading:t,showMessage:n})}),(0,m.jsx)(b,{isOpen:y,onClose:()=>v(!1)}),(0,m.jsx)(E,{isOpen:k,onClose:()=>S(!1)}),(0,m.jsx)(N,{isOpen:C,onClose:()=>A(!1)}),(0,m.jsx)(ne,{isOpen:T,onClose:()=>B(!1)}),I&&(0,m.jsxs)("div",{style:{position:"fixed",top:"10%",left:"50%",transform:"translateX(-50%)",zIndex:1e3,background:"#fff",padding:"20px",borderRadius:"8px",boxShadow:"0px 4px 10px rgba(0,0,0,0.2)"},children:[(0,m.jsx)(s.$,{icon:(0,m.jsx)(P.Jtj,{}),appearance:"subtle",onClick:()=>D(!1),style:{position:"absolute",top:"8px",right:"8px"},"aria-label":"Close"}),(0,m.jsx)(Z,{})]})]})}}}]);
//# sourceMappingURL=page-tools.js.map