/*! For license information please see page-search.js.LICENSE.txt */
"use strict";(self.webpackChunkoffice_addin_taskpane_react_js=self.webpackChunkoffice_addin_taskpane_react_js||[]).push([[279],{6058:function(e,t,n){n.r(t);var a=n(6540),l=n(4956),o=n(2766),r=n(2471),c=n(272),i=n(72),u=n(6725),s=n(9027),d=n(6964).Promise;const f={overlay:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.3)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modal:{width:"90%",maxWidth:"900px",maxHeight:"90vh",overflowY:"auto",background:"#fff",padding:"20px",borderRadius:"5px",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column"},title:{textAlign:"left",fontSize:"18px",marginBottom:"15px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},tabContainer:{display:"flex",marginBottom:"10px"},tabButton:{flex:1,padding:"10px",border:"none",backgroundColor:"#fff",cursor:"pointer",fontSize:"16px"},activeTab:{backgroundColor:"#7e57c2",color:"white",transition:"background 0.3s ease-in-out"},row:{display:"flex",flexDirection:"column",marginBottom:"10px"},input:{padding:"8px",fontSize:"14px",border:"1px solid #ccc",borderRadius:"4px",width:"100%",boxSizing:"border-box"},selectedAccount:{backgroundColor:"#f0f0f0",padding:"5px",borderRadius:"4px",marginBottom:"5px",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"space-between"},undoButton:{background:"#ff6347",color:"#fff",border:"none",marginLeft:"10px",padding:"5px 8px",cursor:"pointer",borderRadius:"4px"},tableContainer:{width:"100%",overflowX:"auto",overflowY:"auto",maxHeight:"400px",border:"1px solid #ccc",borderRadius:"4px"},table:{width:"100%",borderCollapse:"separate",borderSpacing:0,minWidth:"600px"},th:{backgroundColor:"#f7f7f7",padding:"10px",borderBottom:"1px solid #ddd",borderTop:"1px solid #ddd",textAlign:"left",fontSize:"12px",position:"sticky",top:0,zIndex:10},td:{padding:"0 5px",fontSize:"12px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"180px"},tableRow:{cursor:"pointer",transition:"background 0.3s ease-in-out"},tableRowHover:{background:"#f0f0f0"},selectedRow:{background:"#d6eaf8"},buttonRow:{display:"flex",justifyContent:"space-between",marginTop:"15px"},cancelButton:{background:"#ccc",border:"none",padding:"10px 15px",cursor:"pointer",borderRadius:"4px"},fetchButton:{background:"#ccc",border:"none",padding:"10px 15px",cursor:"pointer",borderRadius:"4px"}};t.default=({isOpen:e,onClose:t,onSelect:n})=>{const{setLoading:p,showMessage:m}=(0,u.U)(),[b,y]=(0,a.useState)(""),[h,x]=(0,a.useState)("account"),[g,v]=(0,a.useState)([]),[w,E]=(0,a.useState)([]),[k,C]=(0,a.useState)([]),[_,S]=(0,a.useState)(""),[I,R]=(0,a.useState)(null),[B,L]=(0,a.useState)(null),[T,P]=(0,a.useState)(null),{dataDir:F}=(0,u.U)();if((0,a.useEffect)((()=>{console.log("üîó BASE_URL =",s.C),e&&d.all([fetch(`${s.C}/api/account`).then((e=>e.json())),fetch(`${s.C}/api/cf`).then((e=>e.json())),fetch(`${s.C}/api/customer`).then((e=>e.json()))]).then((([e,t,n])=>{v(e),E(t),C(n)})).catch((e=>console.error("üìå –î–∞—Ç–∞ —Ç–∞—Ç–∞—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞:",e)))}),[e,F]),!e)return null;const j=("account"===h?g:"cf"===h?w:k).filter((e=>"account"===h?e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]?.toLowerCase().includes(_.toLowerCase())||e["–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"]?.toLowerCase().includes(_.toLowerCase()):"cf"===h&&e.code?.toLowerCase().includes(_.toLowerCase())||e.name?.toLowerCase().includes(_.toLowerCase())));return a.createElement("div",{style:f.overlay},a.createElement("div",{style:f.modal},a.createElement(l.w,{selectedValue:h,onTabSelect:(e,t)=>{return n=t.value,x(n),S(""),void L(null);var n},style:f.tabContainer},a.createElement(o.o,{value:"account"},"üè¶ –î–∞–Ω—Å"),a.createElement(o.o,{value:"cf"},"üí∏ CF"),a.createElement(o.o,{value:"customer"},"üë§ –•–∞—Ä–∏–ª—Ü–∞–≥—á")),a.createElement("div",{style:f.row},a.createElement(r.p,{appearance:"outline",contentBefore:a.createElement(c.u5x,null),type:"text",placeholder:"account"===h?"–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä —ç—Å–≤—ç–ª –¥—É–≥–∞–∞—Ä —Ö–∞–π—Ö...":"cf"===h?"CF –Ω—ç—Ä —ç—Å–≤—ç–ª –∫–æ–¥ —Ö–∞–π—Ö...":"–•–∞—Ä–∏–ª—Ü–∞–≥—á–∏–π–Ω –Ω—ç—Ä —Ö–∞–π—Ö...",value:_,onChange:(e,t)=>S(t.value)})),B&&a.createElement("div",{style:f.selectedAccount},a.createElement("strong",null,"–°–æ–Ω–≥–æ–≥–¥—Å–æ–Ω:")," ","account"===h?`${B["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]} - ${B["–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"]}`:"cf"===h?`${B.code} - ${B.name}`:`${B.name}`,a.createElement("button",{style:f.undoButton,onClick:async()=>{null!==T&&(await(0,i.i1)(T,m,p),L(null),P(null))}},"‚ùå –ë—É—Ü–∞–∞—Ö")),a.createElement("div",{style:f.tableContainer},a.createElement("table",{style:f.table},a.createElement("thead",null,a.createElement("tr",null,"account"===h?a.createElement(a.Fragment,null,a.createElement("th",{style:f.th},"ID"),a.createElement("th",{style:f.th},"–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"),a.createElement("th",{style:f.th},"–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"),a.createElement("th",{style:f.th},"–í–∞–ª—é—Ç"),a.createElement("th",{style:f.th},"–°–∞–ª–±–∞—Ä")):"cf"===h?a.createElement(a.Fragment,null,a.createElement("th",{style:f.th},"ID"),a.createElement("th",{style:f.th},"–ö–æ–¥"),a.createElement("th",{style:f.th},"–ù—ç—Ä")):a.createElement(a.Fragment,null,a.createElement("th",{style:f.th},"ID"),a.createElement("th",{style:f.th},"–•–∞—Ä–∏–ª—Ü–∞–≥—á"),a.createElement("th",{style:f.th},"–°—Ç–∞—Ç—É—Å")))),a.createElement("tbody",null,j.map(((e,l)=>a.createElement("tr",{key:l,style:{...f.tableRow,...I===l?f.tableRowHover:{},...B===e?f.selectedRow:{}},onMouseEnter:()=>R(l),onMouseLeave:()=>R(null),onDoubleClick:()=>(async(e,a)=>{try{if(L(e),n)n(e),t();else{const e=await(0,i.bp)(y,p);P(e),await(0,i.i1)(a,y,p)}}catch(e){console.error("‚ùå Row click error:",e)}})(e,"account"===h?e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]:"cf"===h?e.code:e.name)},"account"===h?a.createElement(a.Fragment,null,a.createElement("td",{style:f.td},e.id),a.createElement("td",{style:f.td},e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]),a.createElement("td",{style:f.td},e["–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"]),a.createElement("td",{style:f.td},e["–í–∞–ª—é—Ç"]),a.createElement("td",{style:f.td},e["–°–∞–ª–±–∞—Ä"])):"cf"===h?a.createElement(a.Fragment,null,a.createElement("td",{style:f.td},e.id),a.createElement("td",{style:f.td},e.code),a.createElement("td",{style:f.td},e.name)):a.createElement(a.Fragment,null,a.createElement("td",{style:f.td},e.id),a.createElement("td",{style:f.td},e.name),a.createElement("td",{style:f.td},e.status)))))))),a.createElement("div",{style:f.buttonRow},"account"===h?a.createElement("button",{style:f.fetchButton,onClick:async()=>{try{p(!0),m("‚è≥ –î–∞–Ω—Å–Ω—ã –º—ç–¥—ç—ç–ª–ª–∏–π–≥ —Ç–∞—Ç–∞–∂ –±–∞–π–Ω–∞..."),await(0,i.Mu)(m,p)}catch(e){m("‚ùå –ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞: "+e.message)}finally{p(!1)}}},"üîÑ Account —à–∏–Ω—ç—á–ª—ç—Ö"):a.createElement("button",{style:{visibility:"hidden"}},"."),a.createElement("button",{style:f.cancelButton,onClick:t},"–•–∞–∞—Ö"))))}},7463:function(e,t){function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var a=n-1>>>1,l=e[a];if(!(0<o(l,t)))break e;e[a]=t,e[n]=l,n=a}}function a(e){return 0===e.length?null:e[0]}function l(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,l=e.length,r=l>>>1;a<r;){var c=2*(a+1)-1,i=e[c],u=c+1,s=e[u];if(0>o(i,n))u<l&&0>o(s,i)?(e[a]=s,e[u]=n,a=u):(e[a]=i,e[c]=n,a=c);else{if(!(u<l&&0>o(s,n)))break e;e[a]=s,e[u]=n,a=u}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var r=performance;t.unstable_now=function(){return r.now()}}else{var c=Date,i=c.now();t.unstable_now=function(){return c.now()-i}}var u=[],s=[],d=1,f=null,p=3,m=!1,b=!1,y=!1,h="function"==typeof setTimeout?setTimeout:null,x="function"==typeof clearTimeout?clearTimeout:null,g="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var t=a(s);null!==t;){if(null===t.callback)l(s);else{if(!(t.startTime<=e))break;l(s),t.sortIndex=t.expirationTime,n(u,t)}t=a(s)}}function w(e){if(y=!1,v(e),!b)if(null!==a(u))b=!0,F(E);else{var t=a(s);null!==t&&j(w,t.startTime-e)}}function E(e,n){b=!1,y&&(y=!1,x(S),S=-1),m=!0;var o=p;try{for(v(n),f=a(u);null!==f&&(!(f.expirationTime>n)||e&&!B());){var r=f.callback;if("function"==typeof r){f.callback=null,p=f.priorityLevel;var c=r(f.expirationTime<=n);n=t.unstable_now(),"function"==typeof c?f.callback=c:f===a(u)&&l(u),v(n)}else l(u);f=a(u)}if(null!==f)var i=!0;else{var d=a(s);null!==d&&j(w,d.startTime-n),i=!1}return i}finally{f=null,p=o,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,C=!1,_=null,S=-1,I=5,R=-1;function B(){return!(t.unstable_now()-R<I)}function L(){if(null!==_){var e=t.unstable_now();R=e;var n=!0;try{n=_(!0,e)}finally{n?k():(C=!1,_=null)}}else C=!1}if("function"==typeof g)k=function(){g(L)};else if("undefined"!=typeof MessageChannel){var T=new MessageChannel,P=T.port2;T.port1.onmessage=L,k=function(){P.postMessage(null)}}else k=function(){h(L,0)};function F(e){_=e,C||(C=!0,k())}function j(e,n){S=h((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){b||m||(b=!0,F(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return a(u)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,l,o){var r=t.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?r+o:r,e){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return e={id:d++,callback:l,priorityLevel:e,startTime:o,expirationTime:c=o+c,sortIndex:-1},o>r?(e.sortIndex=o,n(s,e),null===a(u)&&e===a(s)&&(y?(x(S),S=-1):y=!0,j(w,o-r))):(e.sortIndex=c,n(u,e),b||m||(b=!0,F(E))),e},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},9982:function(e,t,n){e.exports=n(7463)}}]);
//# sourceMappingURL=page-search.js.map