/*! For license information please see page-search.js.LICENSE.txt */
"use strict";(self.webpackChunkoffice_addin_taskpane_react_js=self.webpackChunkoffice_addin_taskpane_react_js||[]).push([[279],{6058:function(e,t,n){n.r(t);var a=n(6540),o=n(4956),l=n(2766),r=n(2471),c=n(272),i=n(72),u=n(6725),s=n(9027);const d={overlay:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.3)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modal:{width:"90%",maxWidth:"900px",maxHeight:"90vh",overflowY:"auto",background:"#fff",padding:"20px",borderRadius:"5px",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column"},title:{textAlign:"left",fontSize:"18px",marginBottom:"15px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},tabContainer:{display:"flex",marginBottom:"10px"},tabButton:{flex:1,padding:"10px",border:"none",backgroundColor:"#fff",cursor:"pointer",fontSize:"16px"},activeTab:{backgroundColor:"#7e57c2",color:"white",transition:"background 0.3s ease-in-out"},row:{display:"flex",flexDirection:"column",marginBottom:"10px"},input:{padding:"8px",fontSize:"14px",border:"1px solid #ccc",borderRadius:"4px",width:"100%",boxSizing:"border-box"},selectedAccount:{backgroundColor:"#f0f0f0",padding:"5px",borderRadius:"4px",marginBottom:"5px",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"space-between"},undoButton:{background:"#ff6347",color:"#fff",border:"none",marginLeft:"10px",padding:"5px 8px",cursor:"pointer",borderRadius:"4px"},tableContainer:{width:"100%",overflowX:"auto",overflowY:"auto",maxHeight:"400px",border:"1px solid #ccc",borderRadius:"4px"},table:{width:"100%",borderCollapse:"separate",borderSpacing:0,minWidth:"600px"},th:{backgroundColor:"#f7f7f7",padding:"10px",borderBottom:"1px solid #ddd",borderTop:"1px solid #ddd",textAlign:"left",fontSize:"12px",position:"sticky",top:0,zIndex:10},td:{padding:"0 5px",fontSize:"12px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"180px"},tableRow:{cursor:"pointer",transition:"background 0.3s ease-in-out"},tableRowHover:{background:"#f0f0f0"},selectedRow:{background:"#d6eaf8"},buttonRow:{display:"flex",justifyContent:"space-between",marginTop:"15px"},cancelButton:{background:"#ccc",border:"none",padding:"10px 15px",cursor:"pointer",borderRadius:"4px"},fetchButton:{background:"#ccc",border:"none",padding:"10px 15px",cursor:"pointer",borderRadius:"4px"}};t.default=({isOpen:e,onClose:t,onSelect:n})=>{const{setLoading:f,showMessage:p}=(0,u.U)(),[m,b]=(0,a.useState)(""),[y,h]=(0,a.useState)("account"),[x,g]=(0,a.useState)([]),[v,w]=(0,a.useState)([]),[E,k]=(0,a.useState)([]),[C,_]=(0,a.useState)(""),[S,I]=(0,a.useState)(null),[R,B]=(0,a.useState)(null),[T,L]=(0,a.useState)(null),{dataDir:F}=(0,u.U)();if((0,a.useEffect)((()=>{e&&((0,s.u)(`${s.C}/api/account`).then((e=>e.json())).then(g).catch((e=>console.error("Account –¥–∞—Ç–∞ —É–Ω—à–∏—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞",e))),(0,s.u)(`${s.C}/api/cf`).then((e=>e.json())).then(w).catch((e=>console.error("CF –¥–∞—Ç–∞ —É–Ω—à–∏—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞",e))),(0,s.u)(`${s.C}/api/customer`).then((e=>e.json())).then(k).catch((e=>console.error("Customer –¥–∞—Ç–∞ —É–Ω—à–∏—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞",e))))}),[e,F]),!e)return null;const P=("account"===y?x:"cf"===y?v:E).filter((e=>"account"===y?e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]?.toLowerCase().includes(C.toLowerCase())||e["–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"]?.toLowerCase().includes(C.toLowerCase()):"cf"===y&&e.code?.toLowerCase().includes(C.toLowerCase())||e.name?.toLowerCase().includes(C.toLowerCase())));return a.createElement("div",{style:d.overlay},a.createElement("div",{style:d.modal},a.createElement(o.w,{selectedValue:y,onTabSelect:(e,t)=>{return n=t.value,h(n),_(""),void B(null);var n},style:d.tabContainer},a.createElement(l.o,{value:"account"},"üè¶ –î–∞–Ω—Å"),a.createElement(l.o,{value:"cf"},"üí∏ CF"),a.createElement(l.o,{value:"customer"},"üë§ –•–∞—Ä–∏–ª—Ü–∞–≥—á")),a.createElement("div",{style:d.row},a.createElement(r.p,{appearance:"outline",contentBefore:a.createElement(c.u5x,null),type:"text",placeholder:"account"===y?"–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä —ç—Å–≤—ç–ª –¥—É–≥–∞–∞—Ä —Ö–∞–π—Ö...":"cf"===y?"CF –Ω—ç—Ä —ç—Å–≤—ç–ª –∫–æ–¥ —Ö–∞–π—Ö...":"–•–∞—Ä–∏–ª—Ü–∞–≥—á–∏–π–Ω –Ω—ç—Ä —Ö–∞–π—Ö...",value:C,onChange:(e,t)=>_(t.value)})),R&&a.createElement("div",{style:d.selectedAccount},a.createElement("strong",null,"–°–æ–Ω–≥–æ–≥–¥—Å–æ–Ω:")," ","account"===y?`${R["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]} - ${R["–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"]}`:"cf"===y?`${R.code} - ${R.name}`:`${R.name}`,a.createElement("button",{style:d.undoButton,onClick:async()=>{null!==T&&(await(0,i.i1)(T,p,f),B(null),L(null))}},"‚ùå –ë—É—Ü–∞–∞—Ö")),a.createElement("div",{style:d.tableContainer},a.createElement("table",{style:d.table},a.createElement("thead",null,a.createElement("tr",null,"account"===y?a.createElement(a.Fragment,null,a.createElement("th",{style:d.th},"ID"),a.createElement("th",{style:d.th},"–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"),a.createElement("th",{style:d.th},"–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"),a.createElement("th",{style:d.th},"–í–∞–ª—é—Ç"),a.createElement("th",{style:d.th},"–°–∞–ª–±–∞—Ä")):"cf"===y?a.createElement(a.Fragment,null,a.createElement("th",{style:d.th},"ID"),a.createElement("th",{style:d.th},"–ö–æ–¥"),a.createElement("th",{style:d.th},"–ù—ç—Ä")):a.createElement(a.Fragment,null,a.createElement("th",{style:d.th},"ID"),a.createElement("th",{style:d.th},"–•–∞—Ä–∏–ª—Ü–∞–≥—á"),a.createElement("th",{style:d.th},"–°—Ç–∞—Ç—É—Å")))),a.createElement("tbody",null,P.map(((e,o)=>a.createElement("tr",{key:o,style:{...d.tableRow,...S===o?d.tableRowHover:{},...R===e?d.selectedRow:{}},onMouseEnter:()=>I(o),onMouseLeave:()=>I(null),onDoubleClick:()=>(async(e,a)=>{try{if(B(e),n)n(e),t();else{const e=await(0,i.bp)(b,f);L(e),await(0,i.i1)(a,b,f)}}catch(e){console.error("‚ùå Row click error:",e)}})(e,"account"===y?e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]:"cf"===y?e.code:e.name)},"account"===y?a.createElement(a.Fragment,null,a.createElement("td",{style:d.td},e.id),a.createElement("td",{style:d.td},e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]),a.createElement("td",{style:d.td},e["–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"]),a.createElement("td",{style:d.td},e["–í–∞–ª—é—Ç"]),a.createElement("td",{style:d.td},e["–°–∞–ª–±–∞—Ä"])):"cf"===y?a.createElement(a.Fragment,null,a.createElement("td",{style:d.td},e.id),a.createElement("td",{style:d.td},e.code),a.createElement("td",{style:d.td},e.name)):a.createElement(a.Fragment,null,a.createElement("td",{style:d.td},e.id),a.createElement("td",{style:d.td},e.name),a.createElement("td",{style:d.td},e.status)))))))),a.createElement("div",{style:d.buttonRow},"account"===y?a.createElement("button",{style:d.fetchButton,onClick:async()=>{try{f(!0),p("‚è≥ –î–∞–Ω—Å–Ω—ã –º—ç–¥—ç—ç–ª–ª–∏–π–≥ —Ç–∞—Ç–∞–∂ –±–∞–π–Ω–∞..."),await(0,i.Mu)(p,f)}catch(e){p("‚ùå –ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞: "+e.message)}finally{f(!1)}}},"üîÑ Account —à–∏–Ω—ç—á–ª—ç—Ö"):a.createElement("button",{style:{visibility:"hidden"}},"."),a.createElement("button",{style:d.cancelButton,onClick:t},"–•–∞–∞—Ö"))))}},7463:function(e,t){function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var a=n-1>>>1,o=e[a];if(!(0<l(o,t)))break e;e[a]=t,e[n]=o,n=a}}function a(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,o=e.length,r=o>>>1;a<r;){var c=2*(a+1)-1,i=e[c],u=c+1,s=e[u];if(0>l(i,n))u<o&&0>l(s,i)?(e[a]=s,e[u]=n,a=u):(e[a]=i,e[c]=n,a=c);else{if(!(u<o&&0>l(s,n)))break e;e[a]=s,e[u]=n,a=u}}}return t}function l(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var r=performance;t.unstable_now=function(){return r.now()}}else{var c=Date,i=c.now();t.unstable_now=function(){return c.now()-i}}var u=[],s=[],d=1,f=null,p=3,m=!1,b=!1,y=!1,h="function"==typeof setTimeout?setTimeout:null,x="function"==typeof clearTimeout?clearTimeout:null,g="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var t=a(s);null!==t;){if(null===t.callback)o(s);else{if(!(t.startTime<=e))break;o(s),t.sortIndex=t.expirationTime,n(u,t)}t=a(s)}}function w(e){if(y=!1,v(e),!b)if(null!==a(u))b=!0,P(E);else{var t=a(s);null!==t&&j(w,t.startTime-e)}}function E(e,n){b=!1,y&&(y=!1,x(S),S=-1),m=!0;var l=p;try{for(v(n),f=a(u);null!==f&&(!(f.expirationTime>n)||e&&!B());){var r=f.callback;if("function"==typeof r){f.callback=null,p=f.priorityLevel;var c=r(f.expirationTime<=n);n=t.unstable_now(),"function"==typeof c?f.callback=c:f===a(u)&&o(u),v(n)}else o(u);f=a(u)}if(null!==f)var i=!0;else{var d=a(s);null!==d&&j(w,d.startTime-n),i=!1}return i}finally{f=null,p=l,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,C=!1,_=null,S=-1,I=5,R=-1;function B(){return!(t.unstable_now()-R<I)}function T(){if(null!==_){var e=t.unstable_now();R=e;var n=!0;try{n=_(!0,e)}finally{n?k():(C=!1,_=null)}}else C=!1}if("function"==typeof g)k=function(){g(T)};else if("undefined"!=typeof MessageChannel){var L=new MessageChannel,F=L.port2;L.port1.onmessage=T,k=function(){F.postMessage(null)}}else k=function(){h(T,0)};function P(e){_=e,C||(C=!0,k())}function j(e,n){S=h((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){b||m||(b=!0,P(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return a(u)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,o,l){var r=t.unstable_now();switch(l="object"==typeof l&&null!==l&&"number"==typeof(l=l.delay)&&0<l?r+l:r,e){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:l,expirationTime:c=l+c,sortIndex:-1},l>r?(e.sortIndex=l,n(s,e),null===a(u)&&e===a(s)&&(y?(x(S),S=-1):y=!0,j(w,l-r))):(e.sortIndex=c,n(u,e),b||m||(b=!0,P(E))),e},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},9982:function(e,t,n){e.exports=n(7463)}}]);
//# sourceMappingURL=page-search.js.map