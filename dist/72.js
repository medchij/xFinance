"use strict";(self.webpackChunkoffice_addin_taskpane_react_js=self.webpackChunkoffice_addin_taskpane_react_js||[]).push([[72],{72:function(e,t,n){n.d(t,{Ak:function(){return w},BG:function(){return m},Lv:function(){return s},Mu:function(){return k},_Z:function(){return p},bc:function(){return u},bk:function(){return h},bp:function(){return d},cR:function(){return f},i1:function(){return g},ie:function(){return y},kF:function(){return l},tl:function(){return i}});var o=n(927),a=n(9027),r=n(6964).Promise;let s=null;async function c(){const e=await r.all([n.e(102),n.e(686)]).then(n.bind(n,3959));return e.default||e}const l=async(e,{sheetName:t,setLoading:n,setErrorMessage:a,setSheetData:s,setConfirmDialogOpen:l,setImportStatus:u,setSheetDialogOpen:w})=>{const f=e.target.files[0];f&&t?(await(0,o.$A)(n,a,(async()=>{const e=new FileReader,o=await new r(((t,n)=>{e.onload=e=>t(e.target.result),e.onerror=e=>n(e),e.readAsArrayBuffer(f)})),g=new Uint8Array(o),y=await c(),d=y.read(g,{type:"array"}),m=d.SheetNames[0],h=d.Sheets[m],k=y.utils.sheet_to_json(h,{header:1}).map((e=>e.map((e=>"number"==typeof e&&e.toString().length>15||"string"==typeof e&&/^\d{16,}$/.test(e)?"'"+e:e))));if(s(k),await Excel.run((async e=>{const n=e.workbook.worksheets.getItemOrNullObject(t);return await e.sync(),!n.isNullObject})))l(!0);else{const{message:e,success:o}=await i(t,k,!0,n,a);a(e),u(o),w&&w(!0)}})),e.target.value=null):a("‚ùå Sheet –Ω—ç—Ä —ç—Å–≤—ç–ª —Ñ–∞–π–ª –æ–ª–¥—Å–æ–Ω–≥“Ø–π.")};async function i(e,t,n,a,s){return(0,o.$A)(a,s,(async()=>await Excel.run((async o=>{const a=o.workbook;let c=a.worksheets.getItemOrNullObject(e);await o.sync();const l=!c.isNullObject;l||(c=a.worksheets.add(e),await o.sync(),n=!0);let i=0;if(l&&n){const t="Import"===e?"A:M":c.getUsedRange();"string"==typeof t?c.getRange(t).clear():(t.load("address"),await o.sync(),c.getRange(t.address).clear()),await o.sync()}if(l&&!n){const e=c.getRange("A:A").getUsedRangeOrNullObject();e.load("rowCount"),await o.sync(),i=e.isNullObject?0:e.rowCount,s("‚ö†Ô∏è –•—É—É—á–∏–Ω ”©–≥”©–≥–¥–ª–∏–π–≥ —Ö–∞–¥–≥–∞–ª–∂, “Ø—Ä–≥—ç–ª–∂–ª“Ø“Ø–ª–∂ –±–∏—á–ª—ç—ç."),await new r((e=>setTimeout(e,2500)))}const u=t.length,w=t.reduce(((e,t)=>Math.max(e,t.length)),0);if(0===u||0===w)throw new Error("‚ùå SheetData —Ö–æ–æ—Å–æ–Ω –±–∞–π–Ω–∞!");if("Import"===e&&w>13)throw new Error("‚ùå –ë–∞–≥–∞–Ω—ã–Ω —Ç–æ–æ 13-–∞–∞—Å —Ö—ç—Ç—ç—Ä—Å—ç–Ω –±–∞–π–Ω–∞!");const f=t.map((e=>e.length===w?e:[...e,...Array(w-e.length).fill("")])),g=c.getRangeByIndexes(i,0,u,w);g.values=f,g.format.autofitColumns(),g.format.autofitRows(),c.activate(),await o.sync();const y=`‚úÖ "${e}" sheet –¥—ç—ç—Ä ”©–≥”©–≥–¥”©–ª –∞–º–∂–∏–ª—Ç—Ç–∞–π –±–∏—á–∏–≥–¥–ª—ç—ç!`;return s(y),{message:y,success:!0}}))))}async function u(e){try{await Excel.run((async t=>{const n=t.workbook.worksheets.getActiveWorksheet().getRange("A1");n.values=[[e]],n.format.autofitColumns(),await t.sync()}))}catch(e){console.log("Error: "+e)}}const w=async(e,t)=>(0,o.$A)(t,e,(async()=>{await Excel.run((async e=>{const t=e.workbook.getSelectedRange();t.load("values"),await e.sync(),t.numberFormat=[['_(* #,##0_);_(* (#,##0);_(* "-"??_);_(@_)']],t.values=t.values,await e.sync()})),e("‚úÖ –ê–º–∂–∏–ª—Ç—Ç–∞–π!"),console.log("‚úÖ –¢–æ–æ —Ä—É—É —Ö”©—Ä–≤“Ø“Ø–ª—ç–ª—Ç –∞–º–∂–∏–ª—Ç—Ç–∞–π")})),f=async(e,t)=>(0,o.$A)(t,e,(async()=>{await Excel.run((async e=>{const t=e.workbook.getSelectedRange();t.load("values"),await e.sync();const n=t.values.map((e=>e.map((e=>null!==e&&""!==e?`'${e}`:""))));t.values=n,await e.sync()})),e("‚úÖ –ê–º–∂–∏–ª—Ç—Ç–∞–π!"),console.log("‚úÖ –¢–µ–∫—Å—Ç —Ö”©—Ä–≤“Ø“Ø–ª—ç–ª—Ç –∞–º–∂–∏–ª—Ç—Ç–∞–π")})),g=async(e,t,n)=>(0,o.$A)(n,t,(async()=>{await Excel.run((async t=>{t.workbook.getActiveCell().values=`'${e}`,await t.sync()})),t("‚úÖ –ê–º–∂–∏–ª—Ç—Ç–∞–π"),console.log("‚úÖ –ò–¥—ç–≤—Ö—Ç—ç–π –Ω“Ø–¥—ç–Ω–¥ —É—Ç–≥–∞ –∞–º–∂–∏–ª—Ç—Ç–∞–π –±–∏—á–∏–≥–¥–ª—ç—ç:",e)})),y=async(e,t,n)=>(0,o.$A)(n,t,(async()=>{await Excel.run((async t=>{t.workbook.getActiveCell().values=[[e]],await t.sync()})),t("‚úÖ –ê–º–∂–∏–ª—Ç—Ç–∞–π"),console.log("‚úÖ –ò–¥—ç–≤—Ö—Ç—ç–π –Ω“Ø–¥—ç–Ω–¥ —É—Ç–≥–∞ –∞–º–∂–∏–ª—Ç—Ç–∞–π –±–∏—á–∏–≥–¥–ª—ç—ç:",e)})),d=async(e,t)=>(0,o.$A)(t,e,(async()=>{const t=await Excel.run((async e=>{const t=e.workbook.getActiveCell();return t.load("formulas"),await e.sync(),t.formulas[0][0]}));return e(`‚úÖ Formula: ${t}`),console.log("‚úÖ –ò–¥—ç–≤—Ö—Ç—ç–π –±–∞–π–≥–∞–∞ –Ω“Ø–¥–Ω–∏–π formula:",t),t})),m=async(e,t)=>(0,o.$A)(t,e,(async()=>{let t,n;await Excel.run((async o=>{const a=o.workbook.worksheets.getActiveWorksheet(),r=o.workbook.getActiveCell();r.load(["rowIndex","columnIndex","values"]),await o.sync();const s=r.rowIndex,c=r.columnIndex;n=r.values[0][0];const l=a.getUsedRange();l.load(["rowCount","columnCount"]),await o.sync();const i=a.getRangeByIndexes(s,0,1,l.columnCount).getLastCell();i.load("columnIndex"),await o.sync(),i.columnIndex;const u=l.rowCount-s;if(u<=1)throw new Error("‚ö†Ô∏è –î–æ–æ—à –º”©—Ä –∞–ª–≥–∞ –±–∞–π–Ω–∞.");t=a.getRangeByIndexes(s,c,u,1),t.load("address"),await o.sync();try{a.autoFilter.clear()}catch(e){console.warn("AutoFilter –±–∞–π—Ö–≥“Ø–π —ç—Å–≤—ç–ª —Ü—ç–≤—ç—Ä–ª—ç–≥–¥—Å—ç–Ω:",e.message)}a.tables.load("items"),await o.sync(),a.tables.items.forEach((e=>e.convertToRange())),await o.sync();const w=a.tables.add(t.address,!0);w.name="FilteredTable",w.style="TableStyleLight1",w.showBandedRows=!1,w.showBandedColumns=!1,w.getHeaderRowRange().format.fill.clear(),w.getHeaderRowRange().format.font.bold=!1,w.columns.getItemAt(0).filter.applyCustomFilter(`*${n}*`,null);const f=`‚úÖ "${n}" —É—Ç–≥–∞–∞—Ä filter —Ç–∞–≤–∏–≥–¥–ª–∞–∞. FilterRange: ${t.address}`;e(f),console.log(f)}))})),h=async(e,t)=>(0,o.$A)(t,e,(async()=>{await Excel.run((async e=>{const t=e.workbook.worksheets.getActiveWorksheet().tables;t.load("items/name"),await e.sync();const n=t.items.find((e=>"FilteredTable"===e.name));if(!n)throw new Error("‚ö†Ô∏è 'FilteredTable' –Ω—ç—Ä—Ç—ç–π —Ö“Ø—Å–Ω—ç–≥—Ç –æ–ª–¥—Å–æ–Ω–≥“Ø–π.");n.clearFilters(),await e.sync();const o=n.getRange();o.load(["columnCount","values","format"]),await e.sync(),n.convertToRange(),await e.sync();const a=o.getRow(0);a.load("values"),await e.sync();const r=a.values[0].map((e=>"string"==typeof e&&e.toLowerCase().includes("column")?"":e));a.values=[r],await e.sync()})),e("‚úÖ FilteredTable –∞–º–∂–∏–ª—Ç—Ç–∞–π —Ü—ç–≤—ç—Ä–ª—ç–≥–¥–ª—ç—ç."),console.log("‚úÖ FilteredTable –∞–º–∂–∏–ª—Ç—Ç–∞–π —Ü—ç–≤—ç—Ä–ª—ç–≥–¥–ª—ç—ç.")}));async function k(e,t){return(0,o.$A)(t,e,(async()=>{e("‚è≥ –î–∞–Ω—Å–Ω—ã –º—ç–¥—ç—ç–ª–ª–∏–π–≥ —Ç–∞—Ç–∞–∂ –±–∞–π–Ω–∞...");const t=await(0,a.u)(`${a.C}/api/account`,{},2e4);if(!t.ok)throw new Error("–°–µ—Ä–≤–µ—Ä—ç—ç—Å –∞–º–∂–∏–ª—Ç–≥“Ø–π —Ö–∞—Ä–∏—É –∏—Ä–ª—ç—ç.");const n=await t.json();if(!Array.isArray(n))throw new Error("–°–µ—Ä–≤–µ—Ä–∏–π–Ω —Ö–∞—Ä–∏—É –±—É—Ä—É—É —Ñ–æ—Ä–º–∞—Ç—Ç–∞–π –±–∞–π–Ω–∞ (Array —Ö“Ø–ª—ç—ç—Å—ç–Ω).");await Excel.run((async e=>{const t=e.workbook.worksheets.getItemOrNullObject("AccountBalance");if(await e.sync(),t.isNullObject)throw new Error("‚ö†Ô∏è 'AccountBalance' –Ω—ç—Ä—Ç—ç–π —Ö—É—É–¥–∞—Å –æ–ª–¥—Å–æ–Ω–≥“Ø–π.");const o=t.getRange("A5:C5");o.load("values"),await e.sync();const a=o.values[0]||[],r=a.indexOf("–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"),s=a.indexOf("–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"),c=a.indexOf("–í–∞–ª—é—Ç");if(-1===r||-1===s||-1===c)throw new Error("‚ö†Ô∏è A5‚ÄìC5 –º”©—Ä”©–Ω–¥ '–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä', '–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä', '–í–∞–ª—é—Ç' –±–∞–≥–∞–Ω—É—É–¥ –±–∞–π—Ö–≥“Ø–π –±–∞–π–Ω–∞.");n.sort(((e,t)=>{const n=(e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]||"").toString(),o=(t["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]||"").toString();return n.localeCompare(o,void 0,{numeric:!0})})),n.forEach(((e,n)=>{const o=8+n;t.getCell(o,r).values=[[e["–î–∞–Ω—Å–Ω—ã –Ω—ç—Ä"]||""]],t.getCell(o,s).values=[[`'${e["–î–∞–Ω—Å–Ω—ã –¥—É–≥–∞–∞—Ä"]||""}`]],t.getCell(o,c).values=[[e["–í–∞–ª—é—Ç"]||""]]})),await e.sync()})),e("‚úÖ –ê–º–∂–∏–ª—Ç—Ç–∞–π."),console.log("‚úÖ –î–∞–Ω—Å–Ω—ã –º—ç–¥—ç—ç–ª–ª–∏–π–≥ –∞–º–∂–∏–ª—Ç—Ç–∞–π –æ—Ä—É—É–ª–ª–∞–∞:",n.slice(0,3))}))}async function p(e){try{await Excel.run((async t=>{t.workbook.worksheets.getActiveWorksheet();const n=t.workbook.getSelectedRange().getSurroundingRegion();n.load("values, address"),await t.sync();const o=n.values;if(!o||0===o.length)throw new Error("‚ö†Ô∏è CurrentRegion-–¥ —É—Ç–≥–∞ –∞–ª–≥–∞.");const a=await c(),r=a.utils.book_new(),s=a.utils.aoa_to_sheet(o);a.utils.book_append_sheet(r,s,"CurrentRegion");const l=a.write(r,{bookType:"xlsx",type:"array"}),i=new Blob([l],{type:"application/octet-stream"}),u=URL.createObjectURL(i),w=document.createElement("a");w.href=u,w.download="CurrentRegionExport.xlsx",document.body.appendChild(w),w.click(),document.body.removeChild(w),e("‚úÖ CurrentRegion —ç–∫—Å–ø–æ—Ä—Ç —Ö–∏–π–≥–¥–ª—ç—ç.")}))}catch(t){console.error("‚ùå Export error:",t),e("‚ùå –ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞: "+t.message)}}},927:function(e,t,n){n.d(t,{$A:function(){return a},CN:function(){return s},Ij:function(){return c},M5:function(){return r},kB:function(){return f},rj:function(){return u},sz:function(){return i},t5:function(){return l},tv:function(){return w}});var o=n(9027);async function a(e,t,n){try{e(!0);const t=await n();if(t?.response instanceof Response&&(console.log("üì° HTTP:",t.response.statusText+" "+t.response.status),!t.response.ok)){const e=await t.response.text();throw new Error("‚ùå –°–µ—Ä–≤–µ—Ä–∏–π–Ω –∞–ª–¥–∞–∞: "+e)}return t}catch(e){throw t("‚ùå –ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞: "+(e?.message||e)),console.error("API Error:",e?.message||e),e}finally{e(!1)}}async function r(){const e=await(0,o.u)(`${o.C}/api/settings`,{},2e4);if(!e.ok)throw new Error("‚ö†Ô∏è Settings.json —Ç–∞—Ç–∞–∂ —á–∞–¥—Å–∞–Ω–≥“Ø–π");return await e.json()}function s(e,t){return e.find((e=>e.name===t))?.value||""}function c(e,t){return e.find((e=>e.name===t))?.id||""}function l(e,t){if(!e||"number"!=typeof e&&"string"!=typeof e)throw new Error(`üìÖ ${t} –Ω“Ø–¥—ç–Ω–¥ –æ–≥–Ω–æ–æ –æ—Ä—É—É–ª–Ω–∞ —É—É (2025-01-30 —ç—Å–≤—ç–ª Excel –æ–≥–Ω–æ–æ–Ω—ã format)`);if("number"==typeof e){const t=new Date(1899,11,30);e=new Date(t.getTime()+864e5*e).toISOString().split("T")[0]}if("string"==typeof e&&!/^\d{4}-\d{2}-\d{2}$/.test(e))throw new Error(`üìÖ ${t} –±—É—Ä—É—É –±–∞–π–Ω–∞. YYYY-MM-DD —Ö—ç–ª–±—ç—Ä—Ç—ç–π –±–∞–π–≤–∞–ª –∑–æ—Ö–∏–º–∂—Ç–æ–π.`);return e.toString().trim()}function i(e){return"number"==typeof e&&e.toString().length>15?"'"+e.toString():"string"==typeof e&&/^\d{16,}$/.test(e)?"'"+e:e}async function u(e,t=14){try{await Excel.run((async n=>{const o=n.workbook.worksheets.getActiveWorksheet(),a=o.getUsedRange();a.load(["rowCount","columnCount"]),await n.sync();const r=a.rowCount,s=Math.max(0,a.columnCount-(t||0));console.log(`üìä –•—ç—Ä—ç–≥–ª—ç–≥–¥—ç–∂ –±—É–π –º—É–∂: ${r} –º”©—Ä, ${s} –±–∞–≥–∞–Ω–∞ (–±–∞—Ä—É—É–Ω–∞–∞—Å –∞–ª–≥–∞—Å—Å–∞–Ω: ${t})`);for(let e=0;e<s;e++){const t=o.getRangeByIndexes(0,e,r,1);t.load("values"),await n.sync(),t.values.flat().every((e=>null===e||""===e))&&(t.columnHidden=!0)}await n.sync(),e&&e("‚úÖ –•–æ–æ—Å–æ–Ω –±–∞–≥–∞–Ω—É—É–¥ –∞–º–∂–∏–ª—Ç—Ç–∞–π –Ω—É—É–∂ –¥—É—É—Å–ª–∞–∞.")}))}catch(t){console.error("‚ùå –•–æ–æ—Å–æ–Ω –±–∞–≥–∞–Ω–∞ –Ω—É—É—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞:",t),e&&e("‚ùå –ê–ª–¥–∞–∞: "+t.message)}}function w(e,t){const n=t?.status?.code,o=e.status,a=t?.status?.message||t?.message||t?.error||`–°–µ—Ä–≤–µ—Ä–∏–π–Ω —Ö–∞—Ä–∏—É –∞–º–∂–∏–ª—Ç–≥“Ø–π: ${o}`;if(401===o||401===n)throw new Error("Token —Ö“Ø—á–∏–Ω–≥“Ø–π —ç—Å–≤—ç–ª —Ö—É–≥–∞—Ü–∞–∞ –Ω—å –¥—É—É—Å—Å–∞–Ω –±–∞–π–Ω–∞. –î–∞—Ö–∏–Ω –Ω—ç–≤—Ç—ç—Ä–Ω—ç “Ø“Ø.");if(404===o||404===n)throw new Error(`–î–∞—Ç–∞ –æ–ª–¥—Å–æ–Ω–≥“Ø–π: ${a}`);if(400===o||400===n)throw new Error(`–ê–ª–¥–∞–∞—Ç–∞–π —Ö“Ø—Å—ç–ª—Ç: ${a}`);throw new Error(a)}async function f(e,t){return await Excel.run((async n=>{n.workbook.settings.set(e,t),await n.sync()}))}},9027:function(e,t,n){n.d(t,{C:function(){return o},u:function(){return a}});const o="undefined"!=typeof window&&window.__XFINANCE_API_URL||("undefined"!=typeof process&&process.env?.REACT_APP_API_URL?process.env.REACT_APP_API_URL.replace(/\/+$/,""):"https://x-finance-tau.vercel.app");async function a(e,t={},n=2e4){const o=new AbortController,a=setTimeout((()=>o.abort()),n);try{return await fetch(e,{...t,signal:o.signal})}finally{clearTimeout(a)}}}}]);
//# sourceMappingURL=72.js.map