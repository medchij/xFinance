# Орчны Хувьсагчдын Тохиргоо

## Чухал: JWT_SECRET

`JWT_SECRET` орчны хувьсагч нь нэвтрэх эрхийн баталгаажуулалтад **МАШ ЧУХАЛ**. Энэ нууц түлхүүр:
- Нэвтрэх үед JWT токен үүсгэхэд ашиглагдана (`/api/auth/login`)
- API хүсэлт дээр JWT токен шалгахад ашиглагдана

### Асуудлууд:

Хэрэв `JWT_SECRET` бүх файлд нэгэн адил биш эсвэл production орчинд тохируулаагүй бол:
- ✗ `/api/companies` дээр 403 Forbidden алдаа гарна
- ✗ `/api/user-settings` дээр 401 Unauthorized алдаа гарна
- ✗ Хэрэглэгчид нэвтрэх эсвэл API ашиглах боломжгүй болно

### Шийдэл:

#### Локал хөгжүүлэлтэд:
1. Төслийн үндсэн хавтаст `.env.local` файл байгаа эсэхийг шалгана уу:
   ```
   JWT_SECRET=your-very-secret-key
   ```
2. Backend `backend/.env` эсвэл үндсэн `.env.local` файлаас уншина

#### Vercel Production-д:
1. Vercel Dashboard → Project Settings → Environment Variables руу орно уу
2. Шинэ хувьсагч нэмнэ:
   - **Нэр**: `JWT_SECRET`
   - **Утга**: Хүчтэй нууц үүсгэнэ (дор хаяж 32 тэмдэгт)
     - Жишээ: `openssl rand -base64 32`
   - **Орчнууд**: Бүгдийг сонгоно (Production, Preview, Development)
3. Өөрчлөлтүүдийг идэвхжүүлэхийн тулд дахин deploy хийнэ

#### Аюулгүй байдлын зөвлөмжүүд:
- **БИТГИЙ** JWT_SECRET-г GitHub руу commit хийгээрэй
- Production орчинд хүчтэй, санамсаргүй нууц ашиглана уу (доод тал нь 32 тэмдэгт)
- Production орчинд хэзээ ч `'your-very-secret-key'` анхдагч утгыг бүү ашигла
- Хэрэв JWT_SECRET задруулсан бол шинэчилнэ
- JWT_SECRET-г нууцалж, хэнтэй ч битгий хуваалц

### JWT_SECRET ашигладаг файлууд:
- `backend/routes/auth.js` - Токен үүсгэнэ
- `backend/middleware/authenticateToken.js` - Токен шалгана
- `backend/routes/user-settings.js` - Токен шалгана

Гурван файл бүгд ИЖИЛ JWT_SECRET утга ашиглах ЁСТОЙ.

## Бусад Орчны Хувьсагчид

### Өгөгдлийн сан:
- `DATABASE_URL` - PostgreSQL холболтын мөр (`.env` дээр аль хэдийн тохируулагдсан)

### Имэйл үйлчилгээ:
- `EMAIL_USER` - Gmail эсвэл имэйл үйлчилгээний хэрэглэгчийн нэр
- `EMAIL_PASS` - Имэйл үйлчилгээний нууц үг эсвэл програмын нууц үг
- `FRONTEND_URL` - Нууц үг сэргээх холбоосонд зориулсан frontend URL

### Frontend (шаардлагатай бол):
- `NEXT_PUBLIC_*` - `NEXT_PUBLIC_` угтвар бүхий хувьсагчид хөтөч рүү дамжина

## Тестлэх:
JWT_SECRET ажиллаж байгааг баталгаажуулах:
1. Зөв нэвтрэх эрхээр нэвтрэх → Токен авах ёстой
2. Токеныг хуулж Authorization header-тэй API дуудлага туршина
3. Хэрэв 403 эсвэл 401 алдаа гарвал, JWT_SECRET таарахгүй эсвэл тохируулаагүй байна
